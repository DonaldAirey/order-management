/*******************************************************************************
*	<auto-generated>
*	This code was generated by a tool.
*	Runtime Version:1.0.0.0
*
*	Changes to this file may cause incorrect behavior and will be lost if
*	the code is regenerated.
*	</auto-generated>
*******************************************************************************/

/* Set the environment */
set nocount on
set quoted_identifier on

/* The VersionControl table keeps track of the current revision of a table. */
begin transaction

/* Drop the previous table */
if exists (select * from sysobjects where type = 'F' and name = 'VersionControlVersionTag')
	alter table "VersionTag" drop constraint "VersionControlVersionTag"
if exists (select * from sysobjects where type = 'U' and name = 'VersionControl')
	drop table "VersionControl"

/* Create the table */
CREATE TABLE "VersionControl" (
	"Name" "varchar"(64) NOT NULL ,
	"Revision" "decimal" NOT NULL 
) ON "PRIMARY"

/* Primary Clustered Index. */
ALTER TABLE "VersionControl" WITH NOCHECK ADD 
	CONSTRAINT "KeyVersionControl" PRIMARY KEY  CLUSTERED 
	(
		"Name"
	)  ON "PRIMARY" 

/* The table and keys can be committed now. */
commit transaction
go

/* Write the status of the operation to the log. */
if @@error = 0
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionControl", Created'
else
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionControl", Error creating'
go

/* The VersionHistory is a record of all the revisions in this database. */
begin transaction

/* Drop the previous table */
if exists (select * from sysobjects where type = 'F' and name = 'VersionHistoryVersionTag')
	alter table "VersionTag" drop constraint "VersionHistoryVersionTag"
if exists (select * from sysobjects where type = 'U' and name = 'VersionHistory')
	drop table "VersionHistory"

/* Create the table */
CREATE TABLE "VersionHistory" (
	"Label" "sysname" NOT NULL ,
	"Date" "Datetime" NULL ,
	"Active" "bit" NULL 
) ON "PRIMARY"

/* Primary Clustered Index. */
ALTER TABLE "VersionHistory" WITH NOCHECK ADD 
	CONSTRAINT "KeyVersionHistory" PRIMARY KEY  CLUSTERED 
	(
		"Label"
	)  ON "PRIMARY" 

/* The table and keys can be committed now. */
commit transaction
go

/* Write the status of the operation to the log. */
if @@error = 0
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionHistory", Created'
else
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionHistory", Error creating'
go

/* The VersionTag is used to collect various revisions of tables into a single release. */
begin transaction

/* Drop the previous table */
if exists (select * from sysobjects where type = 'U' and name = 'VersionTag')
	drop table "VersionTag"

/* Create the table */
CREATE TABLE "VersionTag" (
	"Label" "sysname" NOT NULL ,
	"Name" "varchar"(64) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
	"Revision" "int" NOT NULL 
) ON "PRIMARY"

/* Primary Clustered Index. */
ALTER TABLE "VersionTag" WITH NOCHECK ADD 
	CONSTRAINT "PKVersionTag" PRIMARY KEY  CLUSTERED 
	(
		"Label",
		"Name"
	)  ON "PRIMARY" 

/* Foreign keys */
ALTER TABLE "VersionTag" ADD 
	CONSTRAINT "VersionControlVersionTag" FOREIGN KEY 
	(
		"Name"
	) REFERENCES "VersionControl" (
		"Name"
	),
	CONSTRAINT "VersionHistoryVersionTag" FOREIGN KEY 
	(
		"Label"
	) REFERENCES "VersionHistory" (
		"Label"
	)

/* The table, indices and constraints can be committed now. */
commit transaction
go

/* Write the status of the operation to the log. */
if @@error = 0
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionTag", Created'
else
	print convert(varchar, getdate(), 120) + 'Z Table: "VersionTag", Error creating'
go

/* The City Table */
if not exists (select * from "VersionControl" where "Name" = 'City')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "City" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'City'
	print convert(varchar, getdate(), 120) + 'Z Table: "City", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'City'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'City'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'City')
		drop table "City"

	/* Create the table. */
	create table "City" (
		"CityId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "City" with nocheck add 
		constraint "CityKey" primary key clustered
		(
			"CityId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "City" with nocheck add 
		constraint "DefaultCityIsArchived" default (0) for "IsArchived",
		constraint "DefaultCityIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'City')
		update "VersionControl" set "Revision" = 0 where "Name" = 'City'
	else
		insert "VersionControl" ("Name", "Revision") select 'City', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'City'
	print convert(varchar, getdate(), 120) + 'Z Table: "City", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'City'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "City", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CommissionSchedule Table */
if not exists (select * from "VersionControl" where "Name" = 'CommissionSchedule')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CommissionSchedule" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CommissionSchedule'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionSchedule", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CommissionSchedule'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CommissionSchedule'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'CommissionSchedule')
		drop table "CommissionSchedule"

	/* Create the table. */
	create table "CommissionSchedule" (
		"CommissionScheduleId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"Name" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CommissionSchedule" with nocheck add 
		constraint "CommissionScheduleKey" primary key clustered
		(
			"CommissionScheduleId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CommissionScheduleKeyExternalId0"
		on "CommissionSchedule"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CommissionSchedule" with nocheck add 
		constraint "DefaultCommissionScheduleIsArchived" default (0) for "IsArchived",
		constraint "DefaultCommissionScheduleIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CommissionSchedule')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CommissionSchedule'
	else
		insert "VersionControl" ("Name", "Revision") select 'CommissionSchedule', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CommissionSchedule'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionSchedule", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CommissionSchedule'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionSchedule", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CommissionType Table */
if not exists (select * from "VersionControl" where "Name" = 'CommissionType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CommissionType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CommissionType'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CommissionType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CommissionType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'CommissionType')
		drop table "CommissionType"

	/* Create the table. */
	create table "CommissionType" (
		"CommissionTypeCode" "int" not null,
		"Description" "nvarchar"(max) null,
		"ExternalId0" "nvarchar"(128) null,
		"Name" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CommissionType" with nocheck add 
		constraint "CommissionTypeKey" primary key clustered
		(
			"CommissionTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CommissionTypeKeyExternalId0"
		on "CommissionType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CommissionType" with nocheck add 
		constraint "DefaultCommissionTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultCommissionTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CommissionType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CommissionType'
	else
		insert "VersionControl" ("Name", "Revision") select 'CommissionType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CommissionType'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CommissionType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CommissionUnit Table */
if not exists (select * from "VersionControl" where "Name" = 'CommissionUnit')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CommissionUnit" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CommissionUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionUnit", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CommissionUnit'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CommissionUnit'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'CommissionUnit')
		drop table "CommissionUnit"

	/* Create the table. */
	create table "CommissionUnit" (
		"CommissionUnitCode" "int" not null,
		"Description" "nvarchar"(max) null,
		"ExternalId0" "nvarchar"(128) null,
		"Name" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CommissionUnit" with nocheck add 
		constraint "CommissionUnitKey" primary key clustered
		(
			"CommissionUnitCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CommissionUnitKeyExternalId0"
		on "CommissionUnit"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CommissionUnit" with nocheck add 
		constraint "DefaultCommissionUnitIsArchived" default (0) for "IsArchived",
		constraint "DefaultCommissionUnitIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CommissionUnit')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CommissionUnit'
	else
		insert "VersionControl" ("Name", "Revision") select 'CommissionUnit', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CommissionUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionUnit", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CommissionUnit'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionUnit", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CommissionTranche Table */
if not exists (select * from "VersionControl" where "Name" = 'CommissionTranche')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CommissionTranche" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CommissionTranche'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionTranche", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CommissionTranche'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CommissionTranche'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CommissionSchedule_CommissionTranche')
		alter table "CommissionTranche" drop constraint "FK_CommissionSchedule_CommissionTranche"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CommissionType_CommissionTranche')
		alter table "CommissionTranche" drop constraint "FK_CommissionType_CommissionTranche"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CommissionUnit_CommissionTranche')
		alter table "CommissionTranche" drop constraint "FK_CommissionUnit_CommissionTranche"
	if exists (select * from sysobjects where type = 'U' and name = 'CommissionTranche')
		drop table "CommissionTranche"

	/* Create the table. */
	create table "CommissionTranche" (
		"CommissionScheduleId" "uniqueIdentifier" not null,
		"CommissionTrancheId" "uniqueIdentifier" not null,
		"CommissionTypeCode" "int" not null,
		"CommissionUnitCode" "int" not null,
		"EndRange" "decimal"(19,7) null,
		"ExternalId0" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"StartRange" "decimal"(19,7) not null,
		"Value" "decimal"(19,7) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CommissionTranche" with nocheck add 
		constraint "CommissionTrancheKey" primary key clustered
		(
			"CommissionTrancheId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CommissionTrancheKeyExternalId0"
		on "CommissionTranche"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CommissionTranche" with nocheck add 
		constraint "DefaultCommissionTrancheIsArchived" default (0) for "IsArchived",
		constraint "DefaultCommissionTrancheIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CommissionTranche')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CommissionTranche'
	else
		insert "VersionControl" ("Name", "Revision") select 'CommissionTranche', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CommissionTranche'
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionTranche", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CommissionTranche'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CommissionTranche", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Condition Table */
if not exists (select * from "VersionControl" where "Name" = 'Condition')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Condition" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Condition'
	print convert(varchar, getdate(), 120) + 'Z Table: "Condition", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Condition'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Condition'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Condition')
		drop table "Condition"

	/* Create the table. */
	create table "Condition" (
		"ConditionCode" "int" not null,
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Condition" with nocheck add 
		constraint "ConditionKey" primary key clustered
		(
			"ConditionCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "ConditionKeyExternalId0"
		on "Condition"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "ConditionKeyExternalId1"
		on "Condition"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "ConditionKeyExternalId2"
		on "Condition"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "ConditionKeyExternalId3"
		on "Condition"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Condition" with nocheck add 
		constraint "DefaultConditionIsArchived" default (0) for "IsArchived",
		constraint "DefaultConditionIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Condition')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Condition'
	else
		insert "VersionControl" ("Name", "Revision") select 'Condition', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Condition'
	print convert(varchar, getdate(), 120) + 'Z Table: "Condition", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Condition'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Condition", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Configuration Table */
if not exists (select * from "VersionControl" where "Name" = 'Configuration')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Configuration" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Configuration'
	print convert(varchar, getdate(), 120) + 'Z Table: "Configuration", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Configuration'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Configuration'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Configuration')
		drop table "Configuration"

	/* Create the table. */
	create table "Configuration" (
		"ConfigurationId" "nvarchar"(128) not null,
		"IndexName" "nvarchar"(64) not null,
		"RelationName" "nvarchar"(64) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Configuration" with nocheck add 
		constraint "ConfigurationKey" primary key clustered
		(
			"ConfigurationId",
			"RelationName"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Configuration" with nocheck add 
		constraint "DefaultConfigurationIsArchived" default (0) for "IsArchived",
		constraint "DefaultConfigurationIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Configuration')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Configuration'
	else
		insert "VersionControl" ("Name", "Revision") select 'Configuration', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Configuration'
	print convert(varchar, getdate(), 120) + 'Z Table: "Configuration", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Configuration'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Configuration", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Country Table */
if not exists (select * from "VersionControl" where "Name" = 'Country')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Country" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Country'
	print convert(varchar, getdate(), 120) + 'Z Table: "Country", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Country'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Country'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Country')
		drop table "Country"

	/* Create the table. */
	create table "Country" (
		"Abbreviation" "nvarchar"(max) not null,
		"CountryId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Country" with nocheck add 
		constraint "CountryKey" primary key clustered
		(
			"CountryId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CountryKeyExternalId0"
		on "Country"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "CountryKeyExternalId1"
		on "Country"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Country" with nocheck add 
		constraint "DefaultCountryIsArchived" default (0) for "IsArchived",
		constraint "DefaultCountryIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Country')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Country'
	else
		insert "VersionControl" ("Name", "Revision") select 'Country', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Country'
	print convert(varchar, getdate(), 120) + 'Z Table: "Country", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Country'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Country", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CreditRatingService Table */
if not exists (select * from "VersionControl" where "Name" = 'CreditRatingService')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CreditRatingService" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CreditRatingService'
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRatingService", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CreditRatingService'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CreditRatingService'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'CreditRatingService')
		drop table "CreditRatingService"

	/* Create the table. */
	create table "CreditRatingService" (
		"CreditRatingIdService" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CreditRatingService" with nocheck add 
		constraint "CreditRatingServiceKey" primary key clustered
		(
			"CreditRatingIdService"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CreditRatingIdServiceKeyExternal0"
		on "CreditRatingService"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "CreditRatingIdServiceKeyExternal1"
		on "CreditRatingService"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CreditRatingService" with nocheck add 
		constraint "DefaultCreditRatingServiceIsArchived" default (0) for "IsArchived",
		constraint "DefaultCreditRatingServiceIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CreditRatingService')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CreditRatingService'
	else
		insert "VersionControl" ("Name", "Revision") select 'CreditRatingService', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CreditRatingService'
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRatingService", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CreditRatingService'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRatingService", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The CreditRating Table */
if not exists (select * from "VersionControl" where "Name" = 'CreditRating')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "CreditRating" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'CreditRating'
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRating", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'CreditRating'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'CreditRating'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRatingService_CreditRating')
		alter table "CreditRating" drop constraint "FK_CreditRatingService_CreditRating"
	if exists (select * from sysobjects where type = 'U' and name = 'CreditRating')
		drop table "CreditRating"

	/* Create the table. */
	create table "CreditRating" (
		"CreditRatingId" "uniqueIdentifier" not null,
		"CreditRatingIdService" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"Scale" "nvarchar"(max) not null,
		"Value" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "CreditRating" with nocheck add 
		constraint "CreditRatingKey" primary key clustered
		(
			"CreditRatingId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CreditRatingIdKeyExternal0"
		on "CreditRating"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "CreditRatingIdKeyExternal1"
		on "CreditRating"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "CreditRating" with nocheck add 
		constraint "DefaultCreditRatingIsArchived" default (0) for "IsArchived",
		constraint "DefaultCreditRatingIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'CreditRating')
		update "VersionControl" set "Revision" = 0 where "Name" = 'CreditRating'
	else
		insert "VersionControl" ("Name", "Revision") select 'CreditRating', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'CreditRating'
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRating", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'CreditRating'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "CreditRating", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Crossing Table */
if not exists (select * from "VersionControl" where "Name" = 'Crossing')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Crossing" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Crossing'
	print convert(varchar, getdate(), 120) + 'Z Table: "Crossing", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Crossing'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Crossing'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Crossing')
		drop table "Crossing"

	/* Create the table. */
	create table "Crossing" (
		"CrossingCode" "int" not null,
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Crossing" with nocheck add 
		constraint "CrossingKey" primary key clustered
		(
			"CrossingCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "CrossingKeyExternalId0"
		on "Crossing"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "CrossingKeyExternalId1"
		on "Crossing"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Crossing" with nocheck add 
		constraint "DefaultCrossingIsArchived" default (0) for "IsArchived",
		constraint "DefaultCrossingIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Crossing')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Crossing'
	else
		insert "VersionControl" ("Name", "Revision") select 'Crossing', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Crossing'
	print convert(varchar, getdate(), 120) + 'Z Table: "Crossing", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Crossing'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Crossing", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Destination Table */
if not exists (select * from "VersionControl" where "Name" = 'Destination')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Destination" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Destination'
	print convert(varchar, getdate(), 120) + 'Z Table: "Destination", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Destination'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Destination'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Destination')
		drop table "Destination"

	/* Create the table. */
	create table "Destination" (
		"CancelCustomFixTag" "nvarchar"(max) null,
		"ClearingFirmId" "nvarchar"(max) null,
		"DestinationId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"FixAccount" "nvarchar"(max) null,
		"FixAccountSuffixLength" "int" null,
		"FixExchangeMnemonic" "nvarchar"(max) null,
		"FixExecBroker" "nvarchar"(max) null,
		"FixExecDestinationListed" "nvarchar"(max) null,
		"FixExecDestinationUnlisted" "nvarchar"(max) null,
		"FixHandleInstListed" "nvarchar"(max) null,
		"FixHandleInstUnlisted" "nvarchar"(max) null,
		"FixIoiRoutingId" "nvarchar"(max) null,
		"FixIoiRoutingType" "nvarchar"(max) null,
		"FixNetCommissionType" "nvarchar"(max) null,
		"FixNoteTagId" "nvarchar"(max) null,
		"FixOnBehalfOf" "nvarchar"(max) null,
		"FixOnBehalfOfSub" "nvarchar"(max) null,
		"FixOrderIdFormat" "nvarchar"(max) not null,
		"FixPassiveTag" "nvarchar"(max) null,
		"FixProactiveTag" "nvarchar"(max) null,
		"FixSourceCompany" "nvarchar"(max) null,
		"FixSourceId" "nvarchar"(max) null,
		"FixSourceTrader" "nvarchar"(max) null,
		"FixTargetCompany" "nvarchar"(max) null,
		"FixTargetLocationId" "nvarchar"(max) null,
		"FixTargetTrader" "nvarchar"(max) null,
		"FixVersion" "nvarchar"(max) not null,
		"IsBroker" "bit" not null,
		"IsCancelAllowed" "bit" not null,
		"IsCancelReplaceAllowed" "bit" not null,
		"IsEcn" "bit" not null,
		"IsExchange" "bit" not null,
		"IsInternal" "bit" not null,
		"IsIoiAllowed" "bit" not null,
		"IsLimitPricingAllowed" "bit" not null,
		"IsMarketOnClosePricingAllowed" "bit" not null,
		"IsMarketPricingAllowed" "bit" not null,
		"IsSystemUp" "bit" not null,
		"IsTagEligible" "bit" null,
		"IsTradeAwayAllowed" "bit" not null,
		"IsUnsolicitedTradeAllowed" "bit" null,
		"LotSize" "int" null,
		"MaximumQuantityListedLimit" "decimal"(19,7) null,
		"MaximumQuantityListedMarket" "decimal"(19,7) null,
		"MaximumQuantityUnlistedLimit" "decimal"(19,7) null,
		"MaximumQuantityUnlistedMarket" "decimal"(19,7) null,
		"ModifiedTime" "datetime" not null,
		"Name" "nvarchar"(max) null,
		"NewOrderCustomFixTag" "nvarchar"(max) null,
		"OatsDepartmentId" "nvarchar"(max) null,
		"OatsDestinationCode" "nvarchar"(max) null,
		"OatsReceivingMpi" "nvarchar"(max) null,
		"OatsRouteMethod" "nvarchar"(max) null,
		"OatsRoutingMpi" "nvarchar"(max) null,
		"OatsSentMpi" "nvarchar"(max) null,
		"OatsTerminalId" "nvarchar"(max) null,
		"OnCloseCancelTime" "int" null,
		"OnCloseOrderTime" "int" null,
		"PerShareUsageFee" "decimal"(19,7) null,
		"PostMarketLogic" "nvarchar"(max) null,
		"PrimaryBackupDestinationId" "uniqueIdentifier" null,
		"RowVersion" "bigint" not null,
		"SecondaryBackupDestinationId" "uniqueIdentifier" null,
		"SelectnetFlag" "bit" not null,
		"ShortName" "nvarchar"(max) not null,
		"SourceId0" "nvarchar"(max) null,
		"SourceId1" "nvarchar"(max) null,
		"SourceId2" "nvarchar"(max) null,
		"SourceId3" "nvarchar"(max) null,
		"SourceId4" "nvarchar"(max) null,
		"SourceId5" "nvarchar"(max) null,
		"SourceId6" "nvarchar"(max) null,
		"SourceId7" "nvarchar"(max) null,
		"UniqueShortName" "nvarchar"(max) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Destination" with nocheck add 
		constraint "DestinationKey" primary key clustered
		(
			"DestinationId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "DestinationKeyExternalId0"
		on "Destination"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "DestinationKeyExternalId1"
		on "Destination"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Destination" with nocheck add 
		constraint "DefaultDestinationIsArchived" default (0) for "IsArchived",
		constraint "DefaultDestinationIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Destination')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Destination'
	else
		insert "VersionControl" ("Name", "Revision") select 'Destination', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Destination'
	print convert(varchar, getdate(), 120) + 'Z Table: "Destination", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Destination'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Destination", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Exchange Table */
if not exists (select * from "VersionControl" where "Name" = 'Exchange')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Exchange" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Exchange'
	print convert(varchar, getdate(), 120) + 'Z Table: "Exchange", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Exchange'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Exchange'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Country_Exchange')
		alter table "Exchange" drop constraint "FK_Country_Exchange"
	if exists (select * from sysobjects where type = 'U' and name = 'Exchange')
		drop table "Exchange"

	/* Create the table. */
	create table "Exchange" (
		"CountryId" "uniqueIdentifier" not null,
		"ExchangeId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"IsListed" "bit" not null,
		"Mnemonic" "nvarchar"(max) not null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Exchange" with nocheck add 
		constraint "ExchangeKey" primary key clustered
		(
			"ExchangeId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "ExchangeKeyExternalId0"
		on "Exchange"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "ExchangeKeyExternalId1"
		on "Exchange"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "ExchangeKeyExternalId2"
		on "Exchange"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "ExchangeKeyExternalId3"
		on "Exchange"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Exchange" with nocheck add 
		constraint "DefaultExchangeIsArchived" default (0) for "IsArchived",
		constraint "DefaultExchangeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Exchange')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Exchange'
	else
		insert "VersionControl" ("Name", "Revision") select 'Exchange', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Exchange'
	print convert(varchar, getdate(), 120) + 'Z Table: "Exchange", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Exchange'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Exchange", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The DestinationExchangeMap Table */
if not exists (select * from "VersionControl" where "Name" = 'DestinationExchangeMap')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "DestinationExchangeMap" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'DestinationExchangeMap'
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationExchangeMap", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'DestinationExchangeMap'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'DestinationExchangeMap'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Destination_DestinationExchangeMap')
		alter table "DestinationExchangeMap" drop constraint "FK_Destination_DestinationExchangeMap"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Exchange_DestinationExchangeMap')
		alter table "DestinationExchangeMap" drop constraint "FK_Exchange_DestinationExchangeMap"
	if exists (select * from sysobjects where type = 'U' and name = 'DestinationExchangeMap')
		drop table "DestinationExchangeMap"

	/* Create the table. */
	create table "DestinationExchangeMap" (
		"DestinationExchangeMapId" "uniqueIdentifier" not null,
		"DestinationId" "uniqueIdentifier" null,
		"ExchangeId" "uniqueIdentifier" null,
		"ExternalId0" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "DestinationExchangeMap" with nocheck add 
		constraint "DestinationExchangeMapKey" primary key clustered
		(
			"DestinationExchangeMapId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "DestinationExchangeMapKeyDestinationIdExchangeId"
		on "DestinationExchangeMap"
		(
			"DestinationId",
			"ExchangeId"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "DestinationExchangeMap" with nocheck add 
		constraint "DefaultDestinationExchangeMapIsArchived" default (0) for "IsArchived",
		constraint "DefaultDestinationExchangeMapIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'DestinationExchangeMap')
		update "VersionControl" set "Revision" = 0 where "Name" = 'DestinationExchangeMap'
	else
		insert "VersionControl" ("Name", "Revision") select 'DestinationExchangeMap', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'DestinationExchangeMap'
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationExchangeMap", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'DestinationExchangeMap'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationExchangeMap", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The HolidayType Table */
if not exists (select * from "VersionControl" where "Name" = 'HolidayType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "HolidayType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'HolidayType'
	print convert(varchar, getdate(), 120) + 'Z Table: "HolidayType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'HolidayType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'HolidayType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'HolidayType')
		drop table "HolidayType"

	/* Create the table. */
	create table "HolidayType" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"HolidayTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "HolidayType" with nocheck add 
		constraint "HolidayTypeKey" primary key clustered
		(
			"HolidayTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "HolidayTypeKeyExternalId0"
		on "HolidayType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "HolidayType" with nocheck add 
		constraint "DefaultHolidayTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultHolidayTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'HolidayType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'HolidayType'
	else
		insert "VersionControl" ("Name", "Revision") select 'HolidayType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'HolidayType'
	print convert(varchar, getdate(), 120) + 'Z Table: "HolidayType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'HolidayType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "HolidayType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Holiday Table */
if not exists (select * from "VersionControl" where "Name" = 'Holiday')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Holiday" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Holiday'
	print convert(varchar, getdate(), 120) + 'Z Table: "Holiday", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Holiday'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Holiday'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Country_Holiday')
		alter table "Holiday" drop constraint "FK_Country_Holiday"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_HolidayType_Holiday')
		alter table "Holiday" drop constraint "FK_HolidayType_Holiday"
	if exists (select * from sysobjects where type = 'U' and name = 'Holiday')
		drop table "Holiday"

	/* Create the table. */
	create table "Holiday" (
		"CountryId" "uniqueIdentifier" not null,
		"Date" "datetime" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"HolidayId" "uniqueIdentifier" not null,
		"HolidayTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Holiday" with nocheck add 
		constraint "HolidayKey" primary key clustered
		(
			"HolidayId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "HolidayKeyExternalId0"
		on "Holiday"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "HolidayKeyExternalId1"
		on "Holiday"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Holiday" with nocheck add 
		constraint "DefaultHolidayIsArchived" default (0) for "IsArchived",
		constraint "DefaultHolidayIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Holiday')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Holiday'
	else
		insert "VersionControl" ("Name", "Revision") select 'Holiday', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Holiday'
	print convert(varchar, getdate(), 120) + 'Z Table: "Holiday", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Holiday'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Holiday", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Image Table */
if not exists (select * from "VersionControl" where "Name" = 'Image')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Image" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Image'
	print convert(varchar, getdate(), 120) + 'Z Table: "Image", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Image'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Image'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Image')
		drop table "Image"

	/* Create the table. */
	create table "Image" (
		"ExternalId0" "nvarchar"(128) null,
		"Image" "nvarchar"(max) not null,
		"ImageId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Image" with nocheck add 
		constraint "ImageKey" primary key clustered
		(
			"ImageId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "ImageKeyExternalId0"
		on "Image"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Image" with nocheck add 
		constraint "DefaultImageIsArchived" default (0) for "IsArchived",
		constraint "DefaultImageIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Image')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Image'
	else
		insert "VersionControl" ("Name", "Revision") select 'Image', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Image'
	print convert(varchar, getdate(), 120) + 'Z Table: "Image", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Image'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Image", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The LotHandling Table */
if not exists (select * from "VersionControl" where "Name" = 'LotHandling')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "LotHandling" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'LotHandling'
	print convert(varchar, getdate(), 120) + 'Z Table: "LotHandling", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'LotHandling'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'LotHandling'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'LotHandling')
		drop table "LotHandling"

	/* Create the table. */
	create table "LotHandling" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"LotHandlingCode" "int" not null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "LotHandling" with nocheck add 
		constraint "LotHandlingKey" primary key clustered
		(
			"LotHandlingCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "LotHandlingKeyExternalId0"
		on "LotHandling"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "LotHandlingKeyExternalId1"
		on "LotHandling"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "LotHandlingKeyExternalId2"
		on "LotHandling"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "LotHandlingKeyExternalId3"
		on "LotHandling"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "LotHandling" with nocheck add 
		constraint "DefaultLotHandlingIsArchived" default (0) for "IsArchived",
		constraint "DefaultLotHandlingIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'LotHandling')
		update "VersionControl" set "Revision" = 0 where "Name" = 'LotHandling'
	else
		insert "VersionControl" ("Name", "Revision") select 'LotHandling', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'LotHandling'
	print convert(varchar, getdate(), 120) + 'Z Table: "LotHandling", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'LotHandling'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "LotHandling", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The MajorInstrumentType Table */
if not exists (select * from "VersionControl" where "Name" = 'MajorInstrumentType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "MajorInstrumentType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'MajorInstrumentType'
	print convert(varchar, getdate(), 120) + 'Z Table: "MajorInstrumentType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'MajorInstrumentType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'MajorInstrumentType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'MajorInstrumentType')
		drop table "MajorInstrumentType"

	/* Create the table. */
	create table "MajorInstrumentType" (
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"MajorInstrumentTypeId" "uniqueIdentifier" not null,
		"Mnemonic" "nvarchar"(max) not null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "MajorInstrumentType" with nocheck add 
		constraint "MajorInstrumentTypeKey" primary key clustered
		(
			"MajorInstrumentTypeId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "MajorInstrumentTypeKeyExternalId0"
		on "MajorInstrumentType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "MajorInstrumentTypeKeyExternalId1"
		on "MajorInstrumentType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "MajorInstrumentType" with nocheck add 
		constraint "DefaultMajorInstrumentTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultMajorInstrumentTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'MajorInstrumentType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'MajorInstrumentType'
	else
		insert "VersionControl" ("Name", "Revision") select 'MajorInstrumentType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'MajorInstrumentType'
	print convert(varchar, getdate(), 120) + 'Z Table: "MajorInstrumentType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'MajorInstrumentType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "MajorInstrumentType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The MatchTimer Table */
if not exists (select * from "VersionControl" where "Name" = 'MatchTimer')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "MatchTimer" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'MatchTimer'
	print convert(varchar, getdate(), 120) + 'Z Table: "MatchTimer", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'MatchTimer'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'MatchTimer'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'MatchTimer')
		drop table "MatchTimer"

	/* Create the table. */
	create table "MatchTimer" (
		"CurrentTime" "datetime" not null,
		"MatchId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"StopTime" "datetime" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "MatchTimer" with nocheck add 
		constraint "MatchTimerKey" primary key clustered
		(
			"MatchId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "MatchTimer" with nocheck add 
		constraint "DefaultMatchTimerIsArchived" default (0) for "IsArchived",
		constraint "DefaultMatchTimerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'MatchTimer')
		update "VersionControl" set "Revision" = 0 where "Name" = 'MatchTimer'
	else
		insert "VersionControl" ("Name", "Revision") select 'MatchTimer', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'MatchTimer'
	print convert(varchar, getdate(), 120) + 'Z Table: "MatchTimer", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'MatchTimer'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "MatchTimer", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The MinorInstrumentType Table */
if not exists (select * from "VersionControl" where "Name" = 'MinorInstrumentType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "MinorInstrumentType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'MinorInstrumentType'
	print convert(varchar, getdate(), 120) + 'Z Table: "MinorInstrumentType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'MinorInstrumentType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'MinorInstrumentType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'MinorInstrumentType')
		drop table "MinorInstrumentType"

	/* Create the table. */
	create table "MinorInstrumentType" (
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"MinorInstrumentTypeId" "uniqueIdentifier" not null,
		"Mnemonic" "nvarchar"(max) not null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "MinorInstrumentType" with nocheck add 
		constraint "MinorInstrumentTypeKey" primary key clustered
		(
			"MinorInstrumentTypeId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "MinorInstrumentTypeKeyExternalId0"
		on "MinorInstrumentType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "MinorInstrumentTypeKeyExternalId1"
		on "MinorInstrumentType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "MinorInstrumentType" with nocheck add 
		constraint "DefaultMinorInstrumentTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultMinorInstrumentTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'MinorInstrumentType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'MinorInstrumentType'
	else
		insert "VersionControl" ("Name", "Revision") select 'MinorInstrumentType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'MinorInstrumentType'
	print convert(varchar, getdate(), 120) + 'Z Table: "MinorInstrumentType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'MinorInstrumentType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "MinorInstrumentType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The MssaBucket Table */
if not exists (select * from "VersionControl" where "Name" = 'MssaBucket')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "MssaBucket" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'MssaBucket'
	print convert(varchar, getdate(), 120) + 'Z Table: "MssaBucket", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'MssaBucket'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'MssaBucket'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'MssaBucket')
		drop table "MssaBucket"

	/* Create the table. */
	create table "MssaBucket" (
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"MssaBucketId" "uniqueIdentifier" not null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "MssaBucket" with nocheck add 
		constraint "MssaBucketKey" primary key clustered
		(
			"MssaBucketId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "MssaBucketKeyExternalId0"
		on "MssaBucket"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "MssaBucketKeyExternalId1"
		on "MssaBucket"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "MssaBucket" with nocheck add 
		constraint "DefaultMssaBucketIsArchived" default (0) for "IsArchived",
		constraint "DefaultMssaBucketIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'MssaBucket')
		update "VersionControl" set "Revision" = 0 where "Name" = 'MssaBucket'
	else
		insert "VersionControl" ("Name", "Revision") select 'MssaBucket', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'MssaBucket'
	print convert(varchar, getdate(), 120) + 'Z Table: "MssaBucket", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'MssaBucket'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "MssaBucket", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The OrderType Table */
if not exists (select * from "VersionControl" where "Name" = 'OrderType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "OrderType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'OrderType'
	print convert(varchar, getdate(), 120) + 'Z Table: "OrderType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'OrderType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'OrderType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'OrderType')
		drop table "OrderType"

	/* Create the table. */
	create table "OrderType" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"OrderTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "OrderType" with nocheck add 
		constraint "OrderTypeKey" primary key clustered
		(
			"OrderTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "OrderTypeKeyExternalId0"
		on "OrderType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "OrderTypeKeyExternalId1"
		on "OrderType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "OrderTypeKeyExternalId2"
		on "OrderType"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "OrderTypeKeyExternalId3"
		on "OrderType"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "OrderType" with nocheck add 
		constraint "DefaultOrderTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultOrderTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'OrderType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'OrderType'
	else
		insert "VersionControl" ("Name", "Revision") select 'OrderType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'OrderType'
	print convert(varchar, getdate(), 120) + 'Z Table: "OrderType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'OrderType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "OrderType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The PartyType Table */
if not exists (select * from "VersionControl" where "Name" = 'PartyType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "PartyType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'PartyType'
	print convert(varchar, getdate(), 120) + 'Z Table: "PartyType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'PartyType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'PartyType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'PartyType')
		drop table "PartyType"

	/* Create the table. */
	create table "PartyType" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"PartyTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "PartyType" with nocheck add 
		constraint "PartyTypeKey" primary key clustered
		(
			"PartyTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "PartyTypeKeyExternalId0"
		on "PartyType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "PartyTypeKeyExternalId1"
		on "PartyType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "PartyType" with nocheck add 
		constraint "DefaultPartyTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultPartyTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'PartyType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'PartyType'
	else
		insert "VersionControl" ("Name", "Revision") select 'PartyType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'PartyType'
	print convert(varchar, getdate(), 120) + 'Z Table: "PartyType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'PartyType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "PartyType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The PositionType Table */
if not exists (select * from "VersionControl" where "Name" = 'PositionType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "PositionType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'PositionType'
	print convert(varchar, getdate(), 120) + 'Z Table: "PositionType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'PositionType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'PositionType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'PositionType')
		drop table "PositionType"

	/* Create the table. */
	create table "PositionType" (
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"PositionTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"Sign" "decimal"(19,7) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "PositionType" with nocheck add 
		constraint "PositionTypeKey" primary key clustered
		(
			"PositionTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "PositionTypeKeyExternalId0"
		on "PositionType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "PositionTypeKeyExternalId1"
		on "PositionType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "PositionTypeKeyExternalId2"
		on "PositionType"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "PositionTypeKeyExternalId3"
		on "PositionType"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "PositionType" with nocheck add 
		constraint "DefaultPositionTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultPositionTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'PositionType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'PositionType'
	else
		insert "VersionControl" ("Name", "Revision") select 'PositionType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'PositionType'
	print convert(varchar, getdate(), 120) + 'Z Table: "PositionType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'PositionType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "PositionType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Property Table */
if not exists (select * from "VersionControl" where "Name" = 'Property')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Property" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Property'
	print convert(varchar, getdate(), 120) + 'Z Table: "Property", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Property'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Property'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Property')
		drop table "Property"

	/* Create the table. */
	create table "Property" (
		"ExternalId0" "nvarchar"(64) null,
		"Name" "nvarchar"(max) not null,
		"PropertyId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Property" with nocheck add 
		constraint "PropertyKey" primary key clustered
		(
			"PropertyId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "PropertyKeyExternalId0"
		on "Property"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Property" with nocheck add 
		constraint "DefaultPropertyIsArchived" default (0) for "IsArchived",
		constraint "DefaultPropertyIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Property')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Property'
	else
		insert "VersionControl" ("Name", "Revision") select 'Property', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Property'
	print convert(varchar, getdate(), 120) + 'Z Table: "Property", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Property'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Property", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Province Table */
if not exists (select * from "VersionControl" where "Name" = 'Province')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Province" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Province'
	print convert(varchar, getdate(), 120) + 'Z Table: "Province", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Province'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Province'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Country_Province')
		alter table "Province" drop constraint "FK_Country_Province"
	if exists (select * from sysobjects where type = 'U' and name = 'Province')
		drop table "Province"

	/* Create the table. */
	create table "Province" (
		"Abbreviation" "nvarchar"(max) not null,
		"CountryId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"Name" "nvarchar"(max) not null,
		"ProvinceId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Province" with nocheck add 
		constraint "ProvinceKey" primary key clustered
		(
			"ProvinceId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "ProvinceKeyExternalId0"
		on "Province"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "ProvinceKeyExternalId1"
		on "Province"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Province" with nocheck add 
		constraint "DefaultProvinceIsArchived" default (0) for "IsArchived",
		constraint "DefaultProvinceIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Province')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Province'
	else
		insert "VersionControl" ("Name", "Revision") select 'Province', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Province'
	print convert(varchar, getdate(), 120) + 'Z Table: "Province", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Province'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Province", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The SettlementUnit Table */
if not exists (select * from "VersionControl" where "Name" = 'SettlementUnit')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "SettlementUnit" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'SettlementUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "SettlementUnit", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'SettlementUnit'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'SettlementUnit'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'SettlementUnit')
		drop table "SettlementUnit"

	/* Create the table. */
	create table "SettlementUnit" (
		"Description" "nvarchar"(max) null,
		"ExternalId0" "nvarchar"(128) null,
		"Name" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"SettlementUnitCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "SettlementUnit" with nocheck add 
		constraint "SettlementUnitKey" primary key clustered
		(
			"SettlementUnitCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "SettlementUnitKeyExternalId0"
		on "SettlementUnit"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "SettlementUnit" with nocheck add 
		constraint "DefaultSettlementUnitIsArchived" default (0) for "IsArchived",
		constraint "DefaultSettlementUnitIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'SettlementUnit')
		update "VersionControl" set "Revision" = 0 where "Name" = 'SettlementUnit'
	else
		insert "VersionControl" ("Name", "Revision") select 'SettlementUnit', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'SettlementUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "SettlementUnit", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'SettlementUnit'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "SettlementUnit", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Side Table */
if not exists (select * from "VersionControl" where "Name" = 'Side')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Side" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Side'
	print convert(varchar, getdate(), 120) + 'Z Table: "Side", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Side'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Side'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Side')
		drop table "Side"

	/* Create the table. */
	create table "Side" (
		"CashSign" "decimal"(19,7) not null,
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Image" "nvarchar"(max) not null,
		"Mnemonic" "nvarchar"(max) not null,
		"QuantitySign" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SideCode" "int" not null,
		"SortOrder" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Side" with nocheck add 
		constraint "SideKey" primary key clustered
		(
			"SideCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "SideKeyExternalId0"
		on "Side"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "SideKeyExternalId1"
		on "Side"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "SideKeyExternalId2"
		on "Side"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "SideKeyExternalId3"
		on "Side"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Side" with nocheck add 
		constraint "DefaultSideIsArchived" default (0) for "IsArchived",
		constraint "DefaultSideIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Side')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Side'
	else
		insert "VersionControl" ("Name", "Revision") select 'Side', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Side'
	print convert(varchar, getdate(), 120) + 'Z Table: "Side", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Side'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Side", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The State Table */
if not exists (select * from "VersionControl" where "Name" = 'State')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "State" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'State'
	print convert(varchar, getdate(), 120) + 'Z Table: "State", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'State'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'State'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'State')
		drop table "State"

	/* Create the table. */
	create table "State" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"StateCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "State" with nocheck add 
		constraint "StateKey" primary key clustered
		(
			"StateCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "StateKeyExternalId0"
		on "State"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "StateKeyExternalId1"
		on "State"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "StateKeyExternalId2"
		on "State"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "StateKeyExternalId3"
		on "State"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "State" with nocheck add 
		constraint "DefaultStateIsArchived" default (0) for "IsArchived",
		constraint "DefaultStateIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'State')
		update "VersionControl" set "Revision" = 0 where "Name" = 'State'
	else
		insert "VersionControl" ("Name", "Revision") select 'State', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'State'
	print convert(varchar, getdate(), 120) + 'Z Table: "State", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'State'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "State", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Status Table */
if not exists (select * from "VersionControl" where "Name" = 'Status')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Status" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Status'
	print convert(varchar, getdate(), 120) + 'Z Table: "Status", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Status'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Status'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Status')
		drop table "Status"

	/* Create the table. */
	create table "Status" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Image" "nvarchar"(max) not null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"SortOrder" "int" not null,
		"StatusCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Status" with nocheck add 
		constraint "StatusKey" primary key clustered
		(
			"StatusCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "StatusKeyExternalId0"
		on "Status"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "StatusKeyExternalId1"
		on "Status"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "StatusKeyExternalId2"
		on "Status"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "StatusKeyExternalId3"
		on "Status"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Status" with nocheck add 
		constraint "DefaultStatusIsArchived" default (0) for "IsArchived",
		constraint "DefaultStatusIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Status')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Status'
	else
		insert "VersionControl" ("Name", "Revision") select 'Status', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Status'
	print convert(varchar, getdate(), 120) + 'Z Table: "Status", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Status'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Status", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The SubordinateType Table */
if not exists (select * from "VersionControl" where "Name" = 'SubordinateType')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "SubordinateType" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'SubordinateType'
	print convert(varchar, getdate(), 120) + 'Z Table: "SubordinateType", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'SubordinateType'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'SubordinateType'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'SubordinateType')
		drop table "SubordinateType"

	/* Create the table. */
	create table "SubordinateType" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"SubordinateTypeCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "SubordinateType" with nocheck add 
		constraint "SubordinateTypeKey" primary key clustered
		(
			"SubordinateTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "SubordinateTypeKeyExternalId0"
		on "SubordinateType"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "SubordinateTypeKeyExternalId1"
		on "SubordinateType"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "SubordinateType" with nocheck add 
		constraint "DefaultSubordinateTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultSubordinateTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'SubordinateType')
		update "VersionControl" set "Revision" = 0 where "Name" = 'SubordinateType'
	else
		insert "VersionControl" ("Name", "Revision") select 'SubordinateType', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'SubordinateType'
	print convert(varchar, getdate(), 120) + 'Z Table: "SubordinateType", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'SubordinateType'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "SubordinateType", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The TimeInForce Table */
if not exists (select * from "VersionControl" where "Name" = 'TimeInForce')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "TimeInForce" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'TimeInForce'
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeInForce", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'TimeInForce'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'TimeInForce'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'TimeInForce')
		drop table "TimeInForce"

	/* Create the table. */
	create table "TimeInForce" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"SortOrder" "int" not null,
		"TimeInForceCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "TimeInForce" with nocheck add 
		constraint "TimeInForceKey" primary key clustered
		(
			"TimeInForceCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TimeInForceKeyExternalId0"
		on "TimeInForce"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "TimeInForceKeyExternalId1"
		on "TimeInForce"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "TimeInForceKeyExternalId2"
		on "TimeInForce"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "TimeInForceKeyExternalId3"
		on "TimeInForce"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "TimeInForce" with nocheck add 
		constraint "DefaultTimeInForceIsArchived" default (0) for "IsArchived",
		constraint "DefaultTimeInForceIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'TimeInForce')
		update "VersionControl" set "Revision" = 0 where "Name" = 'TimeInForce'
	else
		insert "VersionControl" ("Name", "Revision") select 'TimeInForce', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'TimeInForce'
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeInForce", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'TimeInForce'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeInForce", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The TimeUnit Table */
if not exists (select * from "VersionControl" where "Name" = 'TimeUnit')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "TimeUnit" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'TimeUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeUnit", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'TimeUnit'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'TimeUnit'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'TimeUnit')
		drop table "TimeUnit"

	/* Create the table. */
	create table "TimeUnit" (
		"ExternalId0" "nvarchar"(128) null,
		"InDays" "decimal"(19,7) not null,
		"Name" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"TimeUnitCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "TimeUnit" with nocheck add 
		constraint "TimeUnitKey" primary key clustered
		(
			"TimeUnitCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TimeUnitKeyExternalId0"
		on "TimeUnit"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "TimeUnit" with nocheck add 
		constraint "DefaultTimeUnitIsArchived" default (0) for "IsArchived",
		constraint "DefaultTimeUnitIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'TimeUnit')
		update "VersionControl" set "Revision" = 0 where "Name" = 'TimeUnit'
	else
		insert "VersionControl" ("Name", "Revision") select 'TimeUnit', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'TimeUnit'
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeUnit", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'TimeUnit'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "TimeUnit", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Type Table */
if not exists (select * from "VersionControl" where "Name" = 'Type')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Type" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Type'
	print convert(varchar, getdate(), 120) + 'Z Table: "Type", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Type'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Type'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Image_Type')
		alter table "Type" drop constraint "FK_Image_Type"
	if exists (select * from sysobjects where type = 'U' and name = 'Type')
		drop table "Type"

	/* Create the table. */
	create table "Type" (
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ImageId" "uniqueIdentifier" null,
		"RowVersion" "bigint" not null,
		"Type" "nvarchar"(max) not null,
		"TypeId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Type" with nocheck add 
		constraint "TypeKey" primary key clustered
		(
			"TypeId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TypeKeyExternalId0"
		on "Type"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Type" with nocheck add 
		constraint "DefaultTypeIsArchived" default (0) for "IsArchived",
		constraint "DefaultTypeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Type')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Type'
	else
		insert "VersionControl" ("Name", "Revision") select 'Type', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Type'
	print convert(varchar, getdate(), 120) + 'Z Table: "Type", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Type'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Type", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Entity Table */
if not exists (select * from "VersionControl" where "Name" = 'Entity')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Entity" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Entity'
	print convert(varchar, getdate(), 120) + 'Z Table: "Entity", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Entity'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Entity'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Image_Entity')
		alter table "Entity" drop constraint "FK_Image_Entity"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Type_Entity')
		alter table "Entity" drop constraint "FK_Type_Entity"
	if exists (select * from sysobjects where type = 'U' and name = 'Entity')
		drop table "Entity"

	/* Create the table. */
	create table "Entity" (
		"CreatedTime" "datetime" not null,
		"Description" "nvarchar"(max) null,
		"EntityId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"ExternalId4" "nvarchar"(128) null,
		"ExternalId5" "nvarchar"(128) null,
		"ExternalId6" "nvarchar"(128) null,
		"ExternalId7" "nvarchar"(128) null,
		"ImageId" "uniqueIdentifier" not null,
		"IsHidden" "bit" not null,
		"IsReadOnly" "bit" not null,
		"ModifiedTime" "datetime" not null,
		"Name" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"TypeId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Entity" with nocheck add 
		constraint "EntityKey" primary key clustered
		(
			"EntityId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "EntityKeyExternalId0"
		on "Entity"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId1"
		on "Entity"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId2"
		on "Entity"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId3"
		on "Entity"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId4"
		on "Entity"
		(
			"ExternalId4"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId5"
		on "Entity"
		(
			"ExternalId5"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId6"
		on "Entity"
		(
			"ExternalId6"
		)  on "PRIMARY" 

	create index "EntityKeyExternalId7"
		on "Entity"
		(
			"ExternalId7"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Entity" with nocheck add 
		constraint "DefaultEntityIsArchived" default (0) for "IsArchived",
		constraint "DefaultEntityIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Entity')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Entity'
	else
		insert "VersionControl" ("Name", "Revision") select 'Entity', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Entity'
	print convert(varchar, getdate(), 120) + 'Z Table: "Entity", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Entity'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Entity", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Blotter Table */
if not exists (select * from "VersionControl" where "Name" = 'Blotter')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Blotter" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Blotter'
	print convert(varchar, getdate(), 120) + 'Z Table: "Blotter", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Blotter'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Blotter'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_Blotter')
		alter table "Blotter" drop constraint "FK_Entity_Blotter"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_PartyType_Blotter')
		alter table "Blotter" drop constraint "FK_PartyType_Blotter"
	if exists (select * from sysobjects where type = 'U' and name = 'Blotter')
		drop table "Blotter"

	/* Create the table. */
	create table "Blotter" (
		"BlotterId" "uniqueIdentifier" not null,
		"PartyTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Blotter" with nocheck add 
		constraint "BlotterKey" primary key clustered
		(
			"BlotterId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Blotter" with nocheck add 
		constraint "DefaultBlotterIsArchived" default (0) for "IsArchived",
		constraint "DefaultBlotterIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Blotter')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Blotter'
	else
		insert "VersionControl" ("Name", "Revision") select 'Blotter', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Blotter'
	print convert(varchar, getdate(), 120) + 'Z Table: "Blotter", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Blotter'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Blotter", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The BlotterDestinationMap Table */
if not exists (select * from "VersionControl" where "Name" = 'BlotterDestinationMap')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "BlotterDestinationMap" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'BlotterDestinationMap'
	print convert(varchar, getdate(), 120) + 'Z Table: "BlotterDestinationMap", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'BlotterDestinationMap'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'BlotterDestinationMap'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_BlotterDestinationMap')
		alter table "BlotterDestinationMap" drop constraint "FK_Blotter_BlotterDestinationMap"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Destination_BlotterDestinationMap')
		alter table "BlotterDestinationMap" drop constraint "FK_Destination_BlotterDestinationMap"
	if exists (select * from sysobjects where type = 'U' and name = 'BlotterDestinationMap')
		drop table "BlotterDestinationMap"

	/* Create the table. */
	create table "BlotterDestinationMap" (
		"BlotterDestinationMapId" "uniqueIdentifier" not null,
		"BlotterId" "uniqueIdentifier" null,
		"DestinationId" "uniqueIdentifier" null,
		"ExternalId0" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "BlotterDestinationMap" with nocheck add 
		constraint "BlotterDestinationMapKey" primary key clustered
		(
			"BlotterDestinationMapId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "BlotterDestinationMapKeyBlotterIdDestinationId"
		on "BlotterDestinationMap"
		(
			"BlotterId",
			"DestinationId"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "BlotterDestinationMap" with nocheck add 
		constraint "DefaultBlotterDestinationMapIsArchived" default (0) for "IsArchived",
		constraint "DefaultBlotterDestinationMapIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'BlotterDestinationMap')
		update "VersionControl" set "Revision" = 0 where "Name" = 'BlotterDestinationMap'
	else
		insert "VersionControl" ("Name", "Revision") select 'BlotterDestinationMap', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'BlotterDestinationMap'
	print convert(varchar, getdate(), 120) + 'Z Table: "BlotterDestinationMap", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'BlotterDestinationMap'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "BlotterDestinationMap", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Branch Table */
if not exists (select * from "VersionControl" where "Name" = 'Branch')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Branch" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Branch'
	print convert(varchar, getdate(), 120) + 'Z Table: "Branch", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Branch'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Branch'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_Branch')
		alter table "Branch" drop constraint "FK_Blotter_Branch"
	if exists (select * from sysobjects where type = 'U' and name = 'Branch')
		drop table "Branch"

	/* Create the table. */
	create table "Branch" (
		"BranchId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"ShortName" "nvarchar"(max) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Branch" with nocheck add 
		constraint "BranchKey" primary key clustered
		(
			"BranchId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Branch" with nocheck add 
		constraint "DefaultBranchIsArchived" default (0) for "IsArchived",
		constraint "DefaultBranchIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Branch')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Branch'
	else
		insert "VersionControl" ("Name", "Revision") select 'Branch', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Branch'
	print convert(varchar, getdate(), 120) + 'Z Table: "Branch", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Branch'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Branch", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The EntityTree Table */
if not exists (select * from "VersionControl" where "Name" = 'EntityTree')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "EntityTree" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'EntityTree'
	print convert(varchar, getdate(), 120) + 'Z Table: "EntityTree", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'EntityTree'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'EntityTree'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_EntityTree_ChildId')
		alter table "EntityTree" drop constraint "FK_Entity_EntityTree_ChildId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_EntityTree_ParentId')
		alter table "EntityTree" drop constraint "FK_Entity_EntityTree_ParentId"
	if exists (select * from sysobjects where type = 'U' and name = 'EntityTree')
		drop table "EntityTree"

	/* Create the table. */
	create table "EntityTree" (
		"ChildId" "uniqueIdentifier" not null,
		"EntityTreeId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ParentId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "EntityTree" with nocheck add 
		constraint "EntityTreeKey" primary key clustered
		(
			"EntityTreeId"
		)  on "PRIMARY" ,
		constraint "EntityTreeKeyChildIdParentId" unique
		(
			"ChildId",
			"ParentId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "EntityTreeKeyExternalId0"
		on "EntityTree"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "EntityTree" with nocheck add 
		constraint "DefaultEntityTreeIsArchived" default (0) for "IsArchived",
		constraint "DefaultEntityTreeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'EntityTree')
		update "VersionControl" set "Revision" = 0 where "Name" = 'EntityTree'
	else
		insert "VersionControl" ("Name", "Revision") select 'EntityTree', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'EntityTree'
	print convert(varchar, getdate(), 120) + 'Z Table: "EntityTree", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'EntityTree'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "EntityTree", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Folder Table */
if not exists (select * from "VersionControl" where "Name" = 'Folder')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Folder" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Folder'
	print convert(varchar, getdate(), 120) + 'Z Table: "Folder", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Folder'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Folder'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_Folder')
		alter table "Folder" drop constraint "FK_Entity_Folder"
	if exists (select * from sysobjects where type = 'U' and name = 'Folder')
		drop table "Folder"

	/* Create the table. */
	create table "Folder" (
		"FolderId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Folder" with nocheck add 
		constraint "FolderKey" primary key clustered
		(
			"FolderId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Folder" with nocheck add 
		constraint "DefaultFolderIsArchived" default (0) for "IsArchived",
		constraint "DefaultFolderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Folder')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Folder'
	else
		insert "VersionControl" ("Name", "Revision") select 'Folder', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Folder'
	print convert(varchar, getdate(), 120) + 'Z Table: "Folder", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Folder'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Folder", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Issuer Table */
if not exists (select * from "VersionControl" where "Name" = 'Issuer')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Issuer" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Issuer'
	print convert(varchar, getdate(), 120) + 'Z Table: "Issuer", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Issuer'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Issuer'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_Issuer')
		alter table "Issuer" drop constraint "FK_Entity_Issuer"
	if exists (select * from sysobjects where type = 'U' and name = 'Issuer')
		drop table "Issuer"

	/* Create the table. */
	create table "Issuer" (
		"IssuerId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Issuer" with nocheck add 
		constraint "IssuerKey" primary key clustered
		(
			"IssuerId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Issuer" with nocheck add 
		constraint "DefaultIssuerIsArchived" default (0) for "IsArchived",
		constraint "DefaultIssuerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Issuer')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Issuer'
	else
		insert "VersionControl" ("Name", "Revision") select 'Issuer', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Issuer'
	print convert(varchar, getdate(), 120) + 'Z Table: "Issuer", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Issuer'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Issuer", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The PropertyStore Table */
if not exists (select * from "VersionControl" where "Name" = 'PropertyStore')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "PropertyStore" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'PropertyStore'
	print convert(varchar, getdate(), 120) + 'Z Table: "PropertyStore", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'PropertyStore'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'PropertyStore'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_PropertyStore')
		alter table "PropertyStore" drop constraint "FK_Entity_PropertyStore"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Property_PropertyStore')
		alter table "PropertyStore" drop constraint "FK_Property_PropertyStore"
	if exists (select * from sysobjects where type = 'U' and name = 'PropertyStore')
		drop table "PropertyStore"

	/* Create the table. */
	create table "PropertyStore" (
		"EntityId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(64) null,
		"PropertyId" "uniqueIdentifier" null,
		"PropertyStoreId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"Value" "sql_variant" null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "PropertyStore" with nocheck add 
		constraint "PropertyStoreKey" primary key clustered
		(
			"PropertyStoreId"
		)  on "PRIMARY" ,
		constraint "PropertyStoreKeyEntityIdPropertyId" unique
		(
			"EntityId",
			"PropertyId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "PropertyStoreKeyExternalId0"
		on "PropertyStore"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "PropertyStore" with nocheck add 
		constraint "DefaultPropertyStoreIsArchived" default (0) for "IsArchived",
		constraint "DefaultPropertyStoreIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'PropertyStore')
		update "VersionControl" set "Revision" = 0 where "Name" = 'PropertyStore'
	else
		insert "VersionControl" ("Name", "Revision") select 'PropertyStore', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'PropertyStore'
	print convert(varchar, getdate(), 120) + 'Z Table: "PropertyStore", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'PropertyStore'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "PropertyStore", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Source Table */
if not exists (select * from "VersionControl" where "Name" = 'Source')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Source" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Source'
	print convert(varchar, getdate(), 120) + 'Z Table: "Source", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Source'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Source'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_Source')
		alter table "Source" drop constraint "FK_Blotter_Source"
	if exists (select * from sysobjects where type = 'U' and name = 'Source')
		drop table "Source"

	/* Create the table. */
	create table "Source" (
		"AdvertisementSchemaId" "uniqueIdentifier" null,
		"BuyMarketValueThreshold" "decimal"(19,7) null,
		"BuyQuantityThreshold" "decimal"(19,7) null,
		"PartyTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"SellMarketValueThreshold" "decimal"(19,7) null,
		"SellQuantityThreshold" "decimal"(19,7) null,
		"ShortName" "nvarchar"(max) not null,
		"SourceId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Source" with nocheck add 
		constraint "SourceKey" primary key clustered
		(
			"SourceId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Source" with nocheck add 
		constraint "DefaultSourceIsArchived" default (0) for "IsArchived",
		constraint "DefaultSourceIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Source')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Source'
	else
		insert "VersionControl" ("Name", "Revision") select 'Source', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Source'
	print convert(varchar, getdate(), 120) + 'Z Table: "Source", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Source'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Source", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Broker Table */
if not exists (select * from "VersionControl" where "Name" = 'Broker')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Broker" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Broker'
	print convert(varchar, getdate(), 120) + 'Z Table: "Broker", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Broker'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Broker'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Source_Broker')
		alter table "Broker" drop constraint "FK_Source_Broker"
	if exists (select * from sysobjects where type = 'U' and name = 'Broker')
		drop table "Broker"

	/* Create the table. */
	create table "Broker" (
		"BrokerId" "uniqueIdentifier" not null,
		"Connected" "bit" not null,
		"Phone" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"Symbol" "nvarchar"(max) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Broker" with nocheck add 
		constraint "BrokerKey" primary key clustered
		(
			"BrokerId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Broker" with nocheck add 
		constraint "DefaultBrokerIsArchived" default (0) for "IsArchived",
		constraint "DefaultBrokerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Broker')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Broker'
	else
		insert "VersionControl" ("Name", "Revision") select 'Broker', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Broker'
	print convert(varchar, getdate(), 120) + 'Z Table: "Broker", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Broker'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Broker", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The ClearingBroker Table */
if not exists (select * from "VersionControl" where "Name" = 'ClearingBroker')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "ClearingBroker" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'ClearingBroker'
	print convert(varchar, getdate(), 120) + 'Z Table: "ClearingBroker", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'ClearingBroker'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'ClearingBroker'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Broker_ClearingBroker')
		alter table "ClearingBroker" drop constraint "FK_Broker_ClearingBroker"
	if exists (select * from sysobjects where type = 'U' and name = 'ClearingBroker')
		drop table "ClearingBroker"

	/* Create the table. */
	create table "ClearingBroker" (
		"ClearingBrokerId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "ClearingBroker" with nocheck add 
		constraint "ClearingBrokerKey" primary key clustered
		(
			"ClearingBrokerId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "ClearingBroker" with nocheck add 
		constraint "DefaultClearingBrokerIsArchived" default (0) for "IsArchived",
		constraint "DefaultClearingBrokerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'ClearingBroker')
		update "VersionControl" set "Revision" = 0 where "Name" = 'ClearingBroker'
	else
		insert "VersionControl" ("Name", "Revision") select 'ClearingBroker', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'ClearingBroker'
	print convert(varchar, getdate(), 120) + 'Z Table: "ClearingBroker", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'ClearingBroker'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "ClearingBroker", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Institution Table */
if not exists (select * from "VersionControl" where "Name" = 'Institution')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Institution" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Institution'
	print convert(varchar, getdate(), 120) + 'Z Table: "Institution", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Institution'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Institution'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Source_Institution')
		alter table "Institution" drop constraint "FK_Source_Institution"
	if exists (select * from sysobjects where type = 'U' and name = 'Institution')
		drop table "Institution"

	/* Create the table. */
	create table "Institution" (
		"InstitutionId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Institution" with nocheck add 
		constraint "InstitutionKey" primary key clustered
		(
			"InstitutionId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Institution" with nocheck add 
		constraint "DefaultInstitutionIsArchived" default (0) for "IsArchived",
		constraint "DefaultInstitutionIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Institution')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Institution'
	else
		insert "VersionControl" ("Name", "Revision") select 'Institution', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Institution'
	print convert(varchar, getdate(), 120) + 'Z Table: "Institution", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Institution'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Institution", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The SystemFolder Table */
if not exists (select * from "VersionControl" where "Name" = 'SystemFolder')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "SystemFolder" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'SystemFolder'
	print convert(varchar, getdate(), 120) + 'Z Table: "SystemFolder", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'SystemFolder'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'SystemFolder'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Folder_SystemFolder')
		alter table "SystemFolder" drop constraint "FK_Folder_SystemFolder"
	if exists (select * from sysobjects where type = 'U' and name = 'SystemFolder')
		drop table "SystemFolder"

	/* Create the table. */
	create table "SystemFolder" (
		"RowVersion" "bigint" not null,
		"SystemFolderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "SystemFolder" with nocheck add 
		constraint "SystemFolderKey" primary key clustered
		(
			"SystemFolderId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "SystemFolder" with nocheck add 
		constraint "DefaultSystemFolderIsArchived" default (0) for "IsArchived",
		constraint "DefaultSystemFolderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'SystemFolder')
		update "VersionControl" set "Revision" = 0 where "Name" = 'SystemFolder'
	else
		insert "VersionControl" ("Name", "Revision") select 'SystemFolder', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'SystemFolder'
	print convert(varchar, getdate(), 120) + 'Z Table: "SystemFolder", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'SystemFolder'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "SystemFolder", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The TypeTree Table */
if not exists (select * from "VersionControl" where "Name" = 'TypeTree')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "TypeTree" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'TypeTree'
	print convert(varchar, getdate(), 120) + 'Z Table: "TypeTree", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'TypeTree'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'TypeTree'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Type_TypeTreeChildId')
		alter table "TypeTree" drop constraint "FK_Type_TypeTreeChildId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Type_TypeTreeParentId')
		alter table "TypeTree" drop constraint "FK_Type_TypeTreeParentId"
	if exists (select * from sysobjects where type = 'U' and name = 'TypeTree')
		drop table "TypeTree"

	/* Create the table. */
	create table "TypeTree" (
		"ChildId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ParentId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"TypeTreeId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "TypeTree" with nocheck add 
		constraint "TypeTreeKey" primary key clustered
		(
			"TypeTreeId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TypeTreeKeyExternalId0"
		on "TypeTree"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "TypeTree" with nocheck add 
		constraint "DefaultTypeTreeIsArchived" default (0) for "IsArchived",
		constraint "DefaultTypeTreeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'TypeTree')
		update "VersionControl" set "Revision" = 0 where "Name" = 'TypeTree'
	else
		insert "VersionControl" ("Name", "Revision") select 'TypeTree', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'TypeTree'
	print convert(varchar, getdate(), 120) + 'Z Table: "TypeTree", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'TypeTree'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "TypeTree", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The User Table */
if not exists (select * from "VersionControl" where "Name" = 'User')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "User" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'User'
	print convert(varchar, getdate(), 120) + 'Z Table: "User", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'User'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'User'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_User')
		alter table "User" drop constraint "FK_Entity_User"
	if exists (select * from sysobjects where type = 'U' and name = 'User')
		drop table "User"

	/* Create the table. */
	create table "User" (
		"DistinguishedName" "nvarchar"(256) not null,
		"IsRemoved" "bit" not null,
		"Preferences" "varbinary"(max) null,
		"RowVersion" "bigint" not null,
		"UserId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "User" with nocheck add 
		constraint "UserKey" primary key clustered
		(
			"UserId"
		)  on "PRIMARY" ,
		constraint "UserKeyDistinguishedName" unique
		(
			"DistinguishedName"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "User" with nocheck add 
		constraint "DefaultUserIsArchived" default (0) for "IsArchived",
		constraint "DefaultUserIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'User')
		update "VersionControl" set "Revision" = 0 where "Name" = 'User'
	else
		insert "VersionControl" ("Name", "Revision") select 'User', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'User'
	print convert(varchar, getdate(), 120) + 'Z Table: "User", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'User'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "User", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The ComplianceOfficer Table */
if not exists (select * from "VersionControl" where "Name" = 'ComplianceOfficer')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "ComplianceOfficer" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'ComplianceOfficer'
	print convert(varchar, getdate(), 120) + 'Z Table: "ComplianceOfficer", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'ComplianceOfficer'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'ComplianceOfficer'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_ComplianceOfficer')
		alter table "ComplianceOfficer" drop constraint "FK_User_ComplianceOfficer"
	if exists (select * from sysobjects where type = 'U' and name = 'ComplianceOfficer')
		drop table "ComplianceOfficer"

	/* Create the table. */
	create table "ComplianceOfficer" (
		"ComplianceOfficerId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "ComplianceOfficer" with nocheck add 
		constraint "ComplianceOfficerKey" primary key clustered
		(
			"ComplianceOfficerId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "ComplianceOfficer" with nocheck add 
		constraint "DefaultComplianceOfficerIsArchived" default (0) for "IsArchived",
		constraint "DefaultComplianceOfficerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'ComplianceOfficer')
		update "VersionControl" set "Revision" = 0 where "Name" = 'ComplianceOfficer'
	else
		insert "VersionControl" ("Name", "Revision") select 'ComplianceOfficer', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'ComplianceOfficer'
	print convert(varchar, getdate(), 120) + 'Z Table: "ComplianceOfficer", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'ComplianceOfficer'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "ComplianceOfficer", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Trader Table */
if not exists (select * from "VersionControl" where "Name" = 'Trader')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Trader" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Trader'
	print convert(varchar, getdate(), 120) + 'Z Table: "Trader", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Trader'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Trader'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_Trader')
		alter table "Trader" drop constraint "FK_Blotter_Trader"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_Trader')
		alter table "Trader" drop constraint "FK_User_Trader"
	if exists (select * from sysobjects where type = 'U' and name = 'Trader')
		drop table "Trader"

	/* Create the table. */
	create table "Trader" (
		"Address1" "nvarchar"(max) null,
		"Address2" "nvarchar"(max) null,
		"Address3" "nvarchar"(max) null,
		"CommissionMaximum" "decimal"(19,7) null,
		"CommissionMinimum" "decimal"(19,7) null,
		"CommissionRate" "decimal"(19,7) null,
		"CommissionRateTypeCode" "int" null,
		"CrossingCode" "int" not null,
		"DefaultAccountId" "uniqueIdentifier" null,
		"DefaultBlotterId" "uniqueIdentifier" null,
		"EmailAddress" "nvarchar"(max) null,
		"FixAccountId" "nvarchar"(max) null,
		"IsAgencyMatch" "bit" not null,
		"IsBrokerMatch" "bit" not null,
		"IsCommissionChangeAllowed" "bit" not null,
		"IsEditExecutionsAllowed" "bit" not null,
		"IsHedgeMatch" "bit" not null,
		"IsHeld" "bit" not null,
		"IsInstitutionMatch" "bit" not null,
		"LastDeletedOrder" "datetime" null,
		"LastFilledOrder" "datetime" null,
		"LastFilledSourceOrder" "datetime" null,
		"LastTrade" "datetime" null,
		"LotSizeDefault" "int" not null,
		"MarketSleep" "int" not null,
		"MaximumVolatilityDefault" "decimal"(19,7) null,
		"NewsFreeTimeDefault" "int" null,
		"OatsAccountType" "nvarchar"(max) null,
		"OatsOrigDeptId" "nvarchar"(max) null,
		"OrderMaximumLimitDelta" "decimal"(19,7) null,
		"OrderMaximumMarketValue" "decimal"(19,7) null,
		"OrderMaximumQuantity" "decimal"(19,7) null,
		"OrderWarningMarketValue" "decimal"(19,7) null,
		"OrderWarningQuantity" "decimal"(19,7) null,
		"Phone" "nvarchar"(max) null,
		"ReviewWindow" "int" not null,
		"RowVersion" "bigint" not null,
		"ScraperConfigurationString" "nvarchar"(max) null,
		"StartTimeDefault" "datetime" null,
		"StopTimeDefault" "datetime" null,
		"TagId" "nvarchar"(max) null,
		"TraderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Trader" with nocheck add 
		constraint "TraderKey" primary key clustered
		(
			"TraderId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Trader" with nocheck add 
		constraint "DefaultTraderIsArchived" default (0) for "IsArchived",
		constraint "DefaultTraderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Trader')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Trader'
	else
		insert "VersionControl" ("Name", "Revision") select 'Trader', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Trader'
	print convert(varchar, getdate(), 120) + 'Z Table: "Trader", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Trader'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Trader", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The BrokerAccount Table */
if not exists (select * from "VersionControl" where "Name" = 'BrokerAccount')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "BrokerAccount" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'BrokerAccount'
	print convert(varchar, getdate(), 120) + 'Z Table: "BrokerAccount", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'BrokerAccount'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'BrokerAccount'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Broker_BrokerAccount')
		alter table "BrokerAccount" drop constraint "FK_Broker_BrokerAccount"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Trader_BrokerAccount')
		alter table "BrokerAccount" drop constraint "FK_Trader_BrokerAccount"
	if exists (select * from sysobjects where type = 'U' and name = 'BrokerAccount')
		drop table "BrokerAccount"

	/* Create the table. */
	create table "BrokerAccount" (
		"BrokerAccountId" "uniqueIdentifier" not null,
		"BrokerId" "uniqueIdentifier" not null,
		"Description" "nvarchar"(max) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"TraderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "BrokerAccount" with nocheck add 
		constraint "BrokerAccountKey" primary key clustered
		(
			"BrokerAccountId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "BrokerAccountKeyExternalId0"
		on "BrokerAccount"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "BrokerAccountKeyExternalId1"
		on "BrokerAccount"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "BrokerAccountKeyExternalId2"
		on "BrokerAccount"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "BrokerAccountKeyExternalId3"
		on "BrokerAccount"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "BrokerAccount" with nocheck add 
		constraint "DefaultBrokerAccountIsArchived" default (0) for "IsArchived",
		constraint "DefaultBrokerAccountIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'BrokerAccount')
		update "VersionControl" set "Revision" = 0 where "Name" = 'BrokerAccount'
	else
		insert "VersionControl" ("Name", "Revision") select 'BrokerAccount', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'BrokerAccount'
	print convert(varchar, getdate(), 120) + 'Z Table: "BrokerAccount", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'BrokerAccount'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "BrokerAccount", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The VolumeCategory Table */
if not exists (select * from "VersionControl" where "Name" = 'VolumeCategory')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "VolumeCategory" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'VolumeCategory'
	print convert(varchar, getdate(), 120) + 'Z Table: "VolumeCategory", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'VolumeCategory'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'VolumeCategory'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'VolumeCategory')
		drop table "VolumeCategory"

	/* Create the table. */
	create table "VolumeCategory" (
		"Description" "nvarchar"(max) null,
		"ExternalId0" "nvarchar"(128) null,
		"HighVolumeRange" "decimal"(19,7) null,
		"LowVolumeRange" "decimal"(19,7) null,
		"Mnemonic" "nvarchar"(max) not null,
		"RowVersion" "bigint" not null,
		"VolumeCategoryCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "VolumeCategory" with nocheck add 
		constraint "VolumeCategoryKey" primary key clustered
		(
			"VolumeCategoryCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "VolumeCategoryKeyExternalId0"
		on "VolumeCategory"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "VolumeCategory" with nocheck add 
		constraint "DefaultVolumeCategoryIsArchived" default (0) for "IsArchived",
		constraint "DefaultVolumeCategoryIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'VolumeCategory')
		update "VersionControl" set "Revision" = 0 where "Name" = 'VolumeCategory'
	else
		insert "VersionControl" ("Name", "Revision") select 'VolumeCategory', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'VolumeCategory'
	print convert(varchar, getdate(), 120) + 'Z Table: "VolumeCategory", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'VolumeCategory'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "VolumeCategory", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Security Table */
if not exists (select * from "VersionControl" where "Name" = 'Security')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Security" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Security'
	print convert(varchar, getdate(), 120) + 'Z Table: "Security", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Security'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Security'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Country_Security')
		alter table "Security" drop constraint "FK_Country_Security"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_Security')
		alter table "Security" drop constraint "FK_Entity_Security"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Issuer_Security')
		alter table "Security" drop constraint "FK_Issuer_Security"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_MajorInstrumentType_Security')
		alter table "Security" drop constraint "FK_MajorInstrumentType_Security"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_MinorInstrumentType_Security')
		alter table "Security" drop constraint "FK_MinorInstrumentType_Security"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_VolumeCategory_Security')
		alter table "Security" drop constraint "FK_VolumeCategory_Security"
	if exists (select * from sysobjects where type = 'U' and name = 'Security')
		drop table "Security"

	/* Create the table. */
	create table "Security" (
		"AverageDailyVolume" "decimal"(19,7) null,
		"CountryId" "uniqueIdentifier" not null,
		"IsDerivative" "bit" not null,
		"IssuerId" "uniqueIdentifier" not null,
		"Logo" "nvarchar"(max) null,
		"MajorInstrumentTypeId" "uniqueIdentifier" not null,
		"MarketCapitalization" "decimal"(19,7) null,
		"MinimumQuantity" "decimal"(19,7) null,
		"MinorInstrumentTypeId" "uniqueIdentifier" not null,
		"PriceFactor" "decimal"(19,7) not null,
		"QuantityFactor" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"Symbol" "nvarchar"(max) not null,
		"VolumeCategoryCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Security" with nocheck add 
		constraint "SecurityKey" primary key clustered
		(
			"SecurityId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Security" with nocheck add 
		constraint "DefaultSecurityIsArchived" default (0) for "IsArchived",
		constraint "DefaultSecurityIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Security')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Security'
	else
		insert "VersionControl" ("Name", "Revision") select 'Security', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Security'
	print convert(varchar, getdate(), 120) + 'Z Table: "Security", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Security'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Security", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Currency Table */
if not exists (select * from "VersionControl" where "Name" = 'Currency')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Currency" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Currency'
	print convert(varchar, getdate(), 120) + 'Z Table: "Currency", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Currency'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Currency'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Currency')
		alter table "Currency" drop constraint "FK_Security_Currency"
	if exists (select * from sysobjects where type = 'U' and name = 'Currency')
		drop table "Currency"

	/* Create the table. */
	create table "Currency" (
		"CurrencyId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Currency" with nocheck add 
		constraint "CurrencyKey" primary key clustered
		(
			"CurrencyId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Currency" with nocheck add 
		constraint "DefaultCurrencyIsArchived" default (0) for "IsArchived",
		constraint "DefaultCurrencyIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Currency')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Currency'
	else
		insert "VersionControl" ("Name", "Revision") select 'Currency', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Currency'
	print convert(varchar, getdate(), 120) + 'Z Table: "Currency", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Currency'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Currency", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The AccountBase Table */
if not exists (select * from "VersionControl" where "Name" = 'AccountBase')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "AccountBase" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'AccountBase'
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountBase", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'AccountBase'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'AccountBase'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Country_AccountBase')
		alter table "AccountBase" drop constraint "FK_Country_AccountBase"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Currency_AccountBase')
		alter table "AccountBase" drop constraint "FK_Currency_AccountBase"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Entity_AccountBase')
		alter table "AccountBase" drop constraint "FK_Entity_AccountBase"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Province_AccountBase')
		alter table "AccountBase" drop constraint "FK_Province_AccountBase"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_AccountBase')
		alter table "AccountBase" drop constraint "FK_User_AccountBase"
	if exists (select * from sysobjects where type = 'U' and name = 'AccountBase')
		drop table "AccountBase"

	/* Create the table. */
	create table "AccountBase" (
		"AccountBaseId" "uniqueIdentifier" not null,
		"Address0" "nvarchar"(max) null,
		"Address1" "nvarchar"(max) null,
		"Address2" "nvarchar"(max) null,
		"City" "nvarchar"(max) null,
		"CountryId" "uniqueIdentifier" null,
		"CurrencyId" "uniqueIdentifier" not null,
		"Mnemonic" "nvarchar"(max) null,
		"PostalCode" "nvarchar"(max) null,
		"ProvinceId" "uniqueIdentifier" null,
		"RowVersion" "bigint" not null,
		"UserData0" "decimal"(19,7) null,
		"UserData1" "decimal"(19,7) null,
		"UserData2" "decimal"(19,7) null,
		"UserData3" "decimal"(19,7) null,
		"UserData4" "nvarchar"(max) null,
		"UserData5" "nvarchar"(max) null,
		"UserData6" "nvarchar"(max) null,
		"UserData7" "nvarchar"(max) null,
		"UserId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "AccountBase" with nocheck add 
		constraint "AccountBaseKey" primary key clustered
		(
			"AccountBaseId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "AccountBase" with nocheck add 
		constraint "DefaultAccountBaseIsArchived" default (0) for "IsArchived",
		constraint "DefaultAccountBaseIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'AccountBase')
		update "VersionControl" set "Revision" = 0 where "Name" = 'AccountBase'
	else
		insert "VersionControl" ("Name", "Revision") select 'AccountBase', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'AccountBase'
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountBase", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'AccountBase'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountBase", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Account Table */
if not exists (select * from "VersionControl" where "Name" = 'Account')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Account" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Account'
	print convert(varchar, getdate(), 120) + 'Z Table: "Account", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Account'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Account'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_AccountBase_Account')
		alter table "Account" drop constraint "FK_AccountBase_Account"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_LotHandling_Account')
		alter table "Account" drop constraint "FK_LotHandling_Account"
	if exists (select * from sysobjects where type = 'U' and name = 'Account')
		drop table "Account"

	/* Create the table. */
	create table "Account" (
		"AccountId" "uniqueIdentifier" not null,
		"LotHandlingCode" "int" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Account" with nocheck add 
		constraint "AccountKey" primary key clustered
		(
			"AccountId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Account" with nocheck add 
		constraint "DefaultAccountIsArchived" default (0) for "IsArchived",
		constraint "DefaultAccountIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Account')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Account'
	else
		insert "VersionControl" ("Name", "Revision") select 'Account', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Account'
	print convert(varchar, getdate(), 120) + 'Z Table: "Account", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Account'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Account", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The AccountGroup Table */
if not exists (select * from "VersionControl" where "Name" = 'AccountGroup')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "AccountGroup" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'AccountGroup'
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountGroup", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'AccountGroup'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'AccountGroup'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_AccountBase_AccountGroup')
		alter table "AccountGroup" drop constraint "FK_AccountBase_AccountGroup"
	if exists (select * from sysobjects where type = 'U' and name = 'AccountGroup')
		drop table "AccountGroup"

	/* Create the table. */
	create table "AccountGroup" (
		"AccountGroupId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "AccountGroup" with nocheck add 
		constraint "AccountGroupKey" primary key clustered
		(
			"AccountGroupId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "AccountGroup" with nocheck add 
		constraint "DefaultAccountGroupIsArchived" default (0) for "IsArchived",
		constraint "DefaultAccountGroupIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'AccountGroup')
		update "VersionControl" set "Revision" = 0 where "Name" = 'AccountGroup'
	else
		insert "VersionControl" ("Name", "Revision") select 'AccountGroup', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'AccountGroup'
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountGroup", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'AccountGroup'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "AccountGroup", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Equity Table */
if not exists (select * from "VersionControl" where "Name" = 'Equity')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Equity" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Equity'
	print convert(varchar, getdate(), 120) + 'Z Table: "Equity", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Equity'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Equity'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Exchange_Equity')
		alter table "Equity" drop constraint "FK_Exchange_Equity"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Equity_EquityId')
		alter table "Equity" drop constraint "FK_Security_Equity_EquityId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Equity_SettlementId')
		alter table "Equity" drop constraint "FK_Security_Equity_SettlementId"
	if exists (select * from sysobjects where type = 'U' and name = 'Equity')
		drop table "Equity"

	/* Create the table. */
	create table "Equity" (
		"EquityId" "uniqueIdentifier" not null,
		"ExchangeId" "uniqueIdentifier" null,
		"IssuerId" "uniqueIdentifier" null,
		"RowVersion" "bigint" not null,
		"SettlementId" "uniqueIdentifier" not null,
		"SharesOutstanding" "decimal"(19,7) null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Equity" with nocheck add 
		constraint "EquityKey" primary key clustered
		(
			"EquityId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Equity" with nocheck add 
		constraint "DefaultEquityIsArchived" default (0) for "IsArchived",
		constraint "DefaultEquityIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Equity')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Equity'
	else
		insert "VersionControl" ("Name", "Revision") select 'Equity', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Equity'
	print convert(varchar, getdate(), 120) + 'Z Table: "Equity", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Equity'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Equity", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Position Table */
if not exists (select * from "VersionControl" where "Name" = 'Position')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Position" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Position'
	print convert(varchar, getdate(), 120) + 'Z Table: "Position", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Position'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Position'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Account_Position')
		alter table "Position" drop constraint "FK_Account_Position"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_PositionType_Position')
		alter table "Position" drop constraint "FK_PositionType_Position"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Position')
		alter table "Position" drop constraint "FK_Security_Position"
	if exists (select * from sysobjects where type = 'U' and name = 'Position')
		drop table "Position"

	/* Create the table. */
	create table "Position" (
		"AccountId" "uniqueIdentifier" not null,
		"PositionTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"UserData0" "decimal"(19,7) null,
		"UserData1" "decimal"(19,7) null,
		"UserData2" "decimal"(19,7) null,
		"UserData3" "decimal"(19,7) null,
		"UserData4" "decimal"(19,7) null,
		"UserData5" "decimal"(19,7) null,
		"UserData6" "decimal"(19,7) null,
		"UserData7" "decimal"(19,7) null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Position" with nocheck add 
		constraint "PositionKey" primary key clustered
		(
			"AccountId",
			"SecurityId",
			"PositionTypeCode"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Position" with nocheck add 
		constraint "DefaultPositionIsArchived" default (0) for "IsArchived",
		constraint "DefaultPositionIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Position')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Position'
	else
		insert "VersionControl" ("Name", "Revision") select 'Position', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Position'
	print convert(varchar, getdate(), 120) + 'Z Table: "Position", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Position'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Position", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Price Table */
if not exists (select * from "VersionControl" where "Name" = 'Price')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Price" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Price'
	print convert(varchar, getdate(), 120) + 'Z Table: "Price", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Price'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Price'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Price_CurrencyId')
		alter table "Price" drop constraint "FK_Security_Price_CurrencyId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Price_SecurityId')
		alter table "Price" drop constraint "FK_Security_Price_SecurityId"
	if exists (select * from sysobjects where type = 'U' and name = 'Price')
		drop table "Price"

	/* Create the table. */
	create table "Price" (
		"AskPrice" "decimal"(19,7) not null,
		"AskSize" "decimal"(19,7) not null,
		"BidPrice" "decimal"(19,7) not null,
		"BidSize" "decimal"(19,7) not null,
		"ClosePrice" "decimal"(19,7) not null,
		"CurrencyId" "uniqueIdentifier" not null,
		"HighPrice" "decimal"(19,7) not null,
		"LastPrice" "decimal"(19,7) not null,
		"LastSize" "decimal"(19,7) not null,
		"LowPrice" "decimal"(19,7) not null,
		"OpenPrice" "decimal"(19,7) not null,
		"PriceChange" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"Volume" "decimal"(19,7) not null,
		"VolumeWeightedAveragePrice" "decimal"(19,7) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Price" with nocheck add 
		constraint "PriceKey" primary key clustered
		(
			"SecurityId",
			"CurrencyId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Price" with nocheck add 
		constraint "DefaultPriceIsArchived" default (0) for "IsArchived",
		constraint "DefaultPriceIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Price')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Price'
	else
		insert "VersionControl" ("Name", "Revision") select 'Price', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Price'
	print convert(varchar, getdate(), 120) + 'Z Table: "Price", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Price'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Price", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The TaxLot Table */
if not exists (select * from "VersionControl" where "Name" = 'TaxLot')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "TaxLot" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'TaxLot'
	print convert(varchar, getdate(), 120) + 'Z Table: "TaxLot", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'TaxLot'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'TaxLot'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Account_TaxLot')
		alter table "TaxLot" drop constraint "FK_Account_TaxLot"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_PositionType_TaxLot')
		alter table "TaxLot" drop constraint "FK_PositionType_TaxLot"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_TaxLot')
		alter table "TaxLot" drop constraint "FK_Security_TaxLot"
	if exists (select * from sysobjects where type = 'U' and name = 'TaxLot')
		drop table "TaxLot"

	/* Create the table. */
	create table "TaxLot" (
		"AccountId" "uniqueIdentifier" not null,
		"Cost" "decimal"(19,7) not null,
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"ExternalId2" "nvarchar"(128) null,
		"ExternalId3" "nvarchar"(128) null,
		"LocalCost" "decimal"(19,7) not null,
		"PositionTypeCode" "int" not null,
		"Quantity" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"SettlementDate" "datetime" null,
		"TaxLotId" "uniqueIdentifier" not null,
		"TradeDate" "datetime" null,
		"UserData0" "decimal"(19,7) null,
		"UserData1" "decimal"(19,7) null,
		"UserData2" "decimal"(19,7) null,
		"UserData3" "decimal"(19,7) null,
		"UserData4" "decimal"(19,7) null,
		"UserData5" "decimal"(19,7) null,
		"UserData6" "decimal"(19,7) null,
		"UserData7" "decimal"(19,7) null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "TaxLot" with nocheck add 
		constraint "TaxLotKey" primary key clustered
		(
			"TaxLotId"
		)  on "PRIMARY" ,
		constraint "TaxLotKeyAccountIdSecurityIdPositionTypeCode" unique
		(
			"AccountId",
			"SecurityId",
			"PositionTypeCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TaxLotKeyExternalId0"
		on "TaxLot"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "TaxLotKeyExternalId1"
		on "TaxLot"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	create index "TaxLotKeyExternalId2"
		on "TaxLot"
		(
			"ExternalId2"
		)  on "PRIMARY" 

	create index "TaxLotKeyExternalId3"
		on "TaxLot"
		(
			"ExternalId3"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "TaxLot" with nocheck add 
		constraint "DefaultTaxLotIsArchived" default (0) for "IsArchived",
		constraint "DefaultTaxLotIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'TaxLot')
		update "VersionControl" set "Revision" = 0 where "Name" = 'TaxLot'
	else
		insert "VersionControl" ("Name", "Revision") select 'TaxLot', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'TaxLot'
	print convert(varchar, getdate(), 120) + 'Z Table: "TaxLot", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'TaxLot'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "TaxLot", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The TraderVolumeSetting Table */
if not exists (select * from "VersionControl" where "Name" = 'TraderVolumeSetting')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "TraderVolumeSetting" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'TraderVolumeSetting'
	print convert(varchar, getdate(), 120) + 'Z Table: "TraderVolumeSetting", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'TraderVolumeSetting'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'TraderVolumeSetting'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Trader_TraderVolumeSetting')
		alter table "TraderVolumeSetting" drop constraint "FK_Trader_TraderVolumeSetting"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_VolumeCategory_TraderVolumeSetting')
		alter table "TraderVolumeSetting" drop constraint "FK_VolumeCategory_TraderVolumeSetting"
	if exists (select * from sysobjects where type = 'U' and name = 'TraderVolumeSetting')
		drop table "TraderVolumeSetting"

	/* Create the table. */
	create table "TraderVolumeSetting" (
		"AutoExecuteQuantity" "decimal"(19,7) not null,
		"ExternalId0" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"ThresholdQuantity" "decimal"(19,7) not null,
		"TraderId" "uniqueIdentifier" not null,
		"TraderVolumeSettingId" "uniqueIdentifier" not null,
		"VolumeCategoryCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "TraderVolumeSetting" with nocheck add 
		constraint "TraderVolumeSettingKey" primary key clustered
		(
			"TraderVolumeSettingId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "TraderVolumeSettingKeyExternalId0"
		on "TraderVolumeSetting"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "TraderVolumeSetting" with nocheck add 
		constraint "DefaultTraderVolumeSettingIsArchived" default (0) for "IsArchived",
		constraint "DefaultTraderVolumeSettingIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'TraderVolumeSetting')
		update "VersionControl" set "Revision" = 0 where "Name" = 'TraderVolumeSetting'
	else
		insert "VersionControl" ("Name", "Revision") select 'TraderVolumeSetting', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'TraderVolumeSetting'
	print convert(varchar, getdate(), 120) + 'Z Table: "TraderVolumeSetting", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'TraderVolumeSetting'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "TraderVolumeSetting", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Weekend Table */
if not exists (select * from "VersionControl" where "Name" = 'Weekend')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Weekend" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Weekend'
	print convert(varchar, getdate(), 120) + 'Z Table: "Weekend", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Weekend'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Weekend'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'Weekend')
		drop table "Weekend"

	/* Create the table. */
	create table "Weekend" (
		"ExternalId0" "nvarchar"(128) null,
		"ExternalId1" "nvarchar"(128) null,
		"RowVersion" "bigint" not null,
		"UserCode0" "int" null,
		"UserCode1" "int" null,
		"WeekendCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Weekend" with nocheck add 
		constraint "WeekendKey" primary key clustered
		(
			"WeekendCode"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "WeekendKeyExternalId0"
		on "Weekend"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	create index "WeekendKeyExternalId1"
		on "Weekend"
		(
			"ExternalId1"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Weekend" with nocheck add 
		constraint "DefaultWeekendIsArchived" default (0) for "IsArchived",
		constraint "DefaultWeekendIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Weekend')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Weekend'
	else
		insert "VersionControl" ("Name", "Revision") select 'Weekend', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Weekend'
	print convert(varchar, getdate(), 120) + 'Z Table: "Weekend", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Weekend'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Weekend", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Debt Table */
if not exists (select * from "VersionControl" where "Name" = 'Debt')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Debt" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Debt'
	print convert(varchar, getdate(), 120) + 'Z Table: "Debt", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Debt'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Debt'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Debt_DebtId')
		alter table "Debt" drop constraint "FK_Security_Debt_DebtId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Debt_SettlementId')
		alter table "Debt" drop constraint "FK_Security_Debt_SettlementId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Weekend_Debt')
		alter table "Debt" drop constraint "FK_Weekend_Debt"
	if exists (select * from sysobjects where type = 'U' and name = 'Debt')
		drop table "Debt"

	/* Create the table. */
	create table "Debt" (
		"DebtId" "uniqueIdentifier" not null,
		"ExdividendDays" "int" not null,
		"FaceOutstanding" "decimal"(19,7) not null,
		"FirstCoupon" "datetime" not null,
		"Frequency" "int" not null,
		"IssuePrice" "int" not null,
		"MaturityDate" "datetime" not null,
		"RedemptionValue" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SettlementId" "uniqueIdentifier" not null,
		"WeekendCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Debt" with nocheck add 
		constraint "DebtKey" primary key clustered
		(
			"DebtId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Debt" with nocheck add 
		constraint "DefaultDebtIsArchived" default (0) for "IsArchived",
		constraint "DefaultDebtIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Debt')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Debt'
	else
		insert "VersionControl" ("Name", "Revision") select 'Debt', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Debt'
	print convert(varchar, getdate(), 120) + 'Z Table: "Debt", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Debt'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Debt", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The DebtAttribute Table */
if not exists (select * from "VersionControl" where "Name" = 'DebtAttribute')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "DebtAttribute" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'DebtAttribute'
	print convert(varchar, getdate(), 120) + 'Z Table: "DebtAttribute", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'DebtAttribute'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'DebtAttribute'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId0')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId0"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId1')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId1"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId2')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId2"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId3')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId3"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId4')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId4"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_CreditRating_DebtAttribute_CreditRatingId5')
		alter table "DebtAttribute" drop constraint "FK_CreditRating_DebtAttribute_CreditRatingId5"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Debt_DebtAttribute')
		alter table "DebtAttribute" drop constraint "FK_Debt_DebtAttribute"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_MssaBucket_DebtAttribute')
		alter table "DebtAttribute" drop constraint "FK_MssaBucket_DebtAttribute"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_SubordinateType_DebtAttribute')
		alter table "DebtAttribute" drop constraint "FK_SubordinateType_DebtAttribute"
	if exists (select * from sysobjects where type = 'U' and name = 'DebtAttribute')
		drop table "DebtAttribute"

	/* Create the table. */
	create table "DebtAttribute" (
		"BetaAdjustedKrd10Year" "decimal"(19,7) not null,
		"BetaAdjustedKrd20Year" "decimal"(19,7) not null,
		"BetaAdjustedKrd2Year" "decimal"(19,7) not null,
		"BetaAdjustedKrd30Year" "decimal"(19,7) not null,
		"BetaAdjustedKrd5Year" "decimal"(19,7) not null,
		"BetaAdjustedKrd6Month" "decimal"(19,7) not null,
		"CleanDeltaPrice" "decimal"(19,7) not null,
		"Coupon" "decimal"(19,7) not null,
		"CreditRatingId0" "uniqueIdentifier" not null,
		"CreditRatingId1" "uniqueIdentifier" not null,
		"CreditRatingId2" "uniqueIdentifier" not null,
		"CreditRatingId3" "uniqueIdentifier" not null,
		"CreditRatingId4" "uniqueIdentifier" not null,
		"CreditRatingId5" "uniqueIdentifier" not null,
		"CurrentYield" "decimal"(19,7) not null,
		"Date" "datetime" not null,
		"DebtId" "uniqueIdentifier" not null,
		"EffectiveConvexity" "decimal"(19,7) not null,
		"EffectiveDuration" "decimal"(19,7) not null,
		"ModifiedDurationToWorst" "decimal"(19,7) not null,
		"ModifiedOptionAdjustedDuration" "decimal"(19,7) not null,
		"MssaBucketId" "uniqueIdentifier" not null,
		"OptionAdjustedDuration" "decimal"(19,7) not null,
		"OptionAdjustedSpread" "decimal"(19,7) not null,
		"OptionAdjustedSpreadDuration" "decimal"(19,7) not null,
		"OptionAdjustedYieldToWorst" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SubordinateTypeCode" "int" not null,
		"YearsToAverageLife" "decimal"(19,7) not null,
		"YearsToMaturity" "decimal"(19,7) not null,
		"YieldToEffectiveMaturity" "decimal"(19,7) not null,
		"YieldToMaturity" "decimal"(19,7) not null,
		"YieldToWorst" "decimal"(19,7) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "DebtAttribute" with nocheck add 
		constraint "DebtAttributeKey" primary key clustered
		(
			"DebtId",
			"Date"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "DebtAttribute" with nocheck add 
		constraint "DefaultDebtAttributeIsArchived" default (0) for "IsArchived",
		constraint "DefaultDebtAttributeIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'DebtAttribute')
		update "VersionControl" set "Revision" = 0 where "Name" = 'DebtAttribute'
	else
		insert "VersionControl" ("Name", "Revision") select 'DebtAttribute', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'DebtAttribute'
	print convert(varchar, getdate(), 120) + 'Z Table: "DebtAttribute", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'DebtAttribute'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "DebtAttribute", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The WorkingOrder Table */
if not exists (select * from "VersionControl" where "Name" = 'WorkingOrder')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "WorkingOrder" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'WorkingOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrder", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'WorkingOrder'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'WorkingOrder'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_Blotter_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Crossing_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_Crossing_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Destination_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_Destination_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_OrderType_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_OrderType_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_WorkingOrder_SecurityId')
		alter table "WorkingOrder" drop constraint "FK_Security_WorkingOrder_SecurityId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_WorkingOrder_SettlementId')
		alter table "WorkingOrder" drop constraint "FK_Security_WorkingOrder_SettlementId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Side_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_Side_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Status_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_Status_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_TimeInForce_WorkingOrder')
		alter table "WorkingOrder" drop constraint "FK_TimeInForce_WorkingOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_WorkingOrder_CreatedUserId')
		alter table "WorkingOrder" drop constraint "FK_User_WorkingOrder_CreatedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_WorkingOrder_ModifiedUserId')
		alter table "WorkingOrder" drop constraint "FK_User_WorkingOrder_ModifiedUserId"
	if exists (select * from sysobjects where type = 'U' and name = 'WorkingOrder')
		drop table "WorkingOrder"

	/* Create the table. */
	create table "WorkingOrder" (
		"AutomaticQuantity" "decimal"(19,7) null,
		"BlotterId" "uniqueIdentifier" not null,
		"CreatedTime" "datetime" not null,
		"CreatedUserId" "uniqueIdentifier" not null,
		"CrossingCode" "int" not null,
		"DestinationId" "uniqueIdentifier" null,
		"ExternalId0" "nvarchar"(128) null,
		"IsAutomatic" "bit" not null,
		"IsAwake" "bit" not null,
		"IsBrokerMatch" "bit" not null,
		"IsHedgeMatch" "bit" not null,
		"IsInstitutionMatch" "bit" not null,
		"LimitPrice" "decimal"(19,7) null,
		"ModifiedTime" "datetime" not null,
		"ModifiedUserId" "uniqueIdentifier" not null,
		"OrderTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"SettlementDate" "datetime" not null,
		"SettlementId" "uniqueIdentifier" null,
		"SideCode" "int" not null,
		"StartTime" "datetime" null,
		"StatusCode" "int" not null,
		"StopPrice" "decimal"(19,7) null,
		"StopTime" "datetime" null,
		"SubmittedQuantity" "decimal"(19,7) not null,
		"SubmittedTime" "datetime" null,
		"TimeInForceCode" "int" not null,
		"TradeDate" "datetime" not null,
		"UploadedTime" "datetime" null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "WorkingOrder" with nocheck add 
		constraint "WorkingOrderKey" primary key clustered
		(
			"WorkingOrderId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "WorkingOrderKeyExternalId0"
		on "WorkingOrder"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "WorkingOrder" with nocheck add 
		constraint "DefaultWorkingOrderIsArchived" default (0) for "IsArchived",
		constraint "DefaultWorkingOrderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'WorkingOrder')
		update "VersionControl" set "Revision" = 0 where "Name" = 'WorkingOrder'
	else
		insert "VersionControl" ("Name", "Revision") select 'WorkingOrder', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'WorkingOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrder", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'WorkingOrder'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrder", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Allocation Table */
if not exists (select * from "VersionControl" where "Name" = 'Allocation')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Allocation" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Allocation'
	print convert(varchar, getdate(), 120) + 'Z Table: "Allocation", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Allocation'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Allocation'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Account_Allocation')
		alter table "Allocation" drop constraint "FK_Account_Allocation"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Allocation_SecurityId')
		alter table "Allocation" drop constraint "FK_Security_Allocation_SecurityId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_Allocation_SettlementId')
		alter table "Allocation" drop constraint "FK_Security_Allocation_SettlementId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Side_Allocation')
		alter table "Allocation" drop constraint "FK_Side_Allocation"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_Allocation_CreatedUserId')
		alter table "Allocation" drop constraint "FK_User_Allocation_CreatedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_Allocation_ModifiedUserId')
		alter table "Allocation" drop constraint "FK_User_Allocation_ModifiedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_WorkingOrder_Allocation')
		alter table "Allocation" drop constraint "FK_WorkingOrder_Allocation"
	if exists (select * from sysobjects where type = 'U' and name = 'Allocation')
		drop table "Allocation"

	/* Create the table. */
	create table "Allocation" (
		"AccountId" "uniqueIdentifier" not null,
		"AccruedInterest" "decimal"(19,7) not null,
		"AllocationId" "uniqueIdentifier" not null,
		"Commission" "decimal"(19,7) not null,
		"CreatedTime" "datetime" not null,
		"CreatedUserId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"ModifiedTime" "datetime" not null,
		"ModifiedUserId" "uniqueIdentifier" not null,
		"PositionTypeCode" "int" not null,
		"Price" "decimal"(19,7) not null,
		"Quantity" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"SettlementDate" "datetime" not null,
		"SettlementId" "uniqueIdentifier" not null,
		"SideCode" "int" not null,
		"TradeDate" "datetime" not null,
		"UserFee0" "decimal"(19,7) not null,
		"UserFee1" "decimal"(19,7) not null,
		"UserFee2" "decimal"(19,7) not null,
		"UserFee3" "decimal"(19,7) not null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Allocation" with nocheck add 
		constraint "AllocationKey" primary key clustered
		(
			"AllocationId"
		)  on "PRIMARY" ,
		constraint "AllocationKeyAccountIdSecurityIdPositionTypeCode" unique
		(
			"AccountId",
			"SecurityId",
			"PositionTypeCode"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Allocation" with nocheck add 
		constraint "DefaultAllocationIsArchived" default (0) for "IsArchived",
		constraint "DefaultAllocationIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Allocation')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Allocation'
	else
		insert "VersionControl" ("Name", "Revision") select 'Allocation', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Allocation'
	print convert(varchar, getdate(), 120) + 'Z Table: "Allocation", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Allocation'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Allocation", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The DestinationOrder Table */
if not exists (select * from "VersionControl" where "Name" = 'DestinationOrder')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "DestinationOrder" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'DestinationOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationOrder", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'DestinationOrder'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'DestinationOrder'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Destination_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_Destination_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_OrderType_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_OrderType_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_DestinationOrder_SecurityId')
		alter table "DestinationOrder" drop constraint "FK_Security_DestinationOrder_SecurityId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_DestinationOrder_SettlementId')
		alter table "DestinationOrder" drop constraint "FK_Security_DestinationOrder_SettlementId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Side_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_Side_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_State_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_State_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Status_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_Status_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_TimeInForce_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_TimeInForce_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Trader_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_Trader_DestinationOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_DestinationOrder_CreatedUserId')
		alter table "DestinationOrder" drop constraint "FK_User_DestinationOrder_CreatedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_DestinationOrder_ModifiedUserId')
		alter table "DestinationOrder" drop constraint "FK_User_DestinationOrder_ModifiedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_WorkingOrder_DestinationOrder')
		alter table "DestinationOrder" drop constraint "FK_WorkingOrder_DestinationOrder"
	if exists (select * from sysobjects where type = 'U' and name = 'DestinationOrder')
		drop table "DestinationOrder"

	/* Create the table. */
	create table "DestinationOrder" (
		"CanceledQuantity" "decimal"(19,7) not null,
		"CanceledTime" "datetime" null,
		"CreatedTime" "datetime" not null,
		"CreatedUserId" "uniqueIdentifier" not null,
		"DestinationId" "uniqueIdentifier" not null,
		"DestinationOrderId" "uniqueIdentifier" not null,
		"ExternalId0" "nvarchar"(128) null,
		"IsCanceledByUser" "bit" not null,
		"IsHidden" "bit" not null,
		"LimitPrice" "decimal"(19,7) null,
		"ModifiedTime" "datetime" not null,
		"ModifiedUserId" "uniqueIdentifier" not null,
		"OrderedQuantity" "decimal"(19,7) not null,
		"OrderTypeCode" "int" not null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" null,
		"SettlementDate" "datetime" not null,
		"SettlementId" "uniqueIdentifier" null,
		"SideCode" "int" not null,
		"StateCode" "int" not null,
		"StatusCode" "int" not null,
		"StopPrice" "decimal"(19,7) null,
		"TimeInForceCode" "int" not null,
		"TradeDate" "datetime" not null,
		"TraderId" "uniqueIdentifier" null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "DestinationOrder" with nocheck add 
		constraint "DestinationOrderKey" primary key clustered
		(
			"DestinationOrderId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "DestinationOrderKeyExternalId0"
		on "DestinationOrder"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "DestinationOrder" with nocheck add 
		constraint "DefaultDestinationOrderIsArchived" default (0) for "IsArchived",
		constraint "DefaultDestinationOrderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'DestinationOrder')
		update "VersionControl" set "Revision" = 0 where "Name" = 'DestinationOrder'
	else
		insert "VersionControl" ("Name", "Revision") select 'DestinationOrder', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'DestinationOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationOrder", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'DestinationOrder'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "DestinationOrder", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Execution Table */
if not exists (select * from "VersionControl" where "Name" = 'Execution')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Execution" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Execution'
	print convert(varchar, getdate(), 120) + 'Z Table: "Execution", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Execution'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Execution'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Broker_Execution')
		alter table "Execution" drop constraint "FK_Broker_Execution"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_BrokerAccount_Execution')
		alter table "Execution" drop constraint "FK_BrokerAccount_Execution"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_DestinationOrder_Execution')
		alter table "Execution" drop constraint "FK_DestinationOrder_Execution"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_State_Execution_DestinationStateCode')
		alter table "Execution" drop constraint "FK_State_Execution_DestinationStateCode"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_State_Execution_SourceStateCode')
		alter table "Execution" drop constraint "FK_State_Execution_SourceStateCode"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_Execution_CreatedUserId')
		alter table "Execution" drop constraint "FK_User_Execution_CreatedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_Execution_ModifiedUserId')
		alter table "Execution" drop constraint "FK_User_Execution_ModifiedUserId"
	if exists (select * from sysobjects where type = 'U' and name = 'Execution')
		drop table "Execution"

	/* Create the table. */
	create table "Execution" (
		"AccruedInterest" "decimal"(19,7) not null,
		"BrokerAccountId" "uniqueIdentifier" null,
		"BrokerId" "uniqueIdentifier" null,
		"Commission" "decimal"(19,7) not null,
		"CreatedTime" "datetime" not null,
		"CreatedUserId" "uniqueIdentifier" not null,
		"DestinationOrderId" "uniqueIdentifier" not null,
		"DestinationStateCode" "int" not null,
		"ExecutionId" "uniqueIdentifier" not null,
		"ExecutionPrice" "decimal"(19,7) not null,
		"ExecutionQuantity" "decimal"(19,7) not null,
		"ExternalId0" "nvarchar"(128) null,
		"IsHidden" "bit" not null,
		"ModifiedTime" "datetime" null,
		"ModifiedUserId" "uniqueIdentifier" null,
		"OriginalDestinationOrderId" "uniqueIdentifier" null,
		"OriginalPrice" "decimal"(19,7) null,
		"OriginalQuantity" "decimal"(19,7) null,
		"RowVersion" "bigint" not null,
		"SourceExecutionId" "nvarchar"(max) null,
		"SourceStateCode" "int" not null,
		"UserFee0" "decimal"(19,7) not null,
		"UserFee1" "decimal"(19,7) not null,
		"UserFee2" "decimal"(19,7) not null,
		"UserFee3" "decimal"(19,7) not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Execution" with nocheck add 
		constraint "ExecutionKey" primary key clustered
		(
			"ExecutionId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "ExecutionKeyExternalId0"
		on "Execution"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "Execution" with nocheck add 
		constraint "DefaultExecutionIsArchived" default (0) for "IsArchived",
		constraint "DefaultExecutionIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Execution')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Execution'
	else
		insert "VersionControl" ("Name", "Revision") select 'Execution', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Execution'
	print convert(varchar, getdate(), 120) + 'Z Table: "Execution", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Execution'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Execution", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Match Table */
if not exists (select * from "VersionControl" where "Name" = 'Match')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Match" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Match'
	print convert(varchar, getdate(), 120) + 'Z Table: "Match", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Match'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Match'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_Match')
		alter table "Match" drop constraint "FK_Blotter_Match"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Status_Match')
		alter table "Match" drop constraint "FK_Status_Match"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_WorkingOrder_Match')
		alter table "Match" drop constraint "FK_WorkingOrder_Match"
	if exists (select * from sysobjects where type = 'U' and name = 'Match')
		drop table "Match"

	/* Create the table. */
	create table "Match" (
		"BlotterId" "uniqueIdentifier" not null,
		"ContraMatchId" "uniqueIdentifier" not null,
		"ContraOrderId" "uniqueIdentifier" not null,
		"HeatIndex" "decimal"(19,7) not null,
		"HeatIndexDetails" "nvarchar"(max) null,
		"MatchedTime" "datetime" not null,
		"MatchId" "uniqueIdentifier" not null,
		"RowVersion" "bigint" not null,
		"StatusCode" "int" not null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Match" with nocheck add 
		constraint "MatchKey" primary key clustered
		(
			"MatchId"
		)  on "PRIMARY" ,
		constraint "MatchKeyWorkingOrderIdContraOrderId" unique
		(
			"WorkingOrderId",
			"ContraOrderId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Match" with nocheck add 
		constraint "DefaultMatchIsArchived" default (0) for "IsArchived",
		constraint "DefaultMatchIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Match')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Match'
	else
		insert "VersionControl" ("Name", "Revision") select 'Match', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Match'
	print convert(varchar, getdate(), 120) + 'Z Table: "Match", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Match'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Match", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The Negotiation Table */
if not exists (select * from "VersionControl" where "Name" = 'Negotiation')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "Negotiation" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'Negotiation'
	print convert(varchar, getdate(), 120) + 'Z Table: "Negotiation", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'Negotiation'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'Negotiation'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Blotter_Negotiation')
		alter table "Negotiation" drop constraint "FK_Blotter_Negotiation"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Execution_Negotiation')
		alter table "Negotiation" drop constraint "FK_Execution_Negotiation"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Match_Negotiation')
		alter table "Negotiation" drop constraint "FK_Match_Negotiation"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Status_Negotiation')
		alter table "Negotiation" drop constraint "FK_Status_Negotiation"
	if exists (select * from sysobjects where type = 'U' and name = 'Negotiation')
		drop table "Negotiation"

	/* Create the table. */
	create table "Negotiation" (
		"BlotterId" "uniqueIdentifier" not null,
		"ExecutionId" "uniqueIdentifier" null,
		"IsRead" "bit" not null,
		"MatchId" "uniqueIdentifier" not null,
		"NegotiationId" "uniqueIdentifier" not null,
		"Quantity" "decimal"(19,7) not null,
		"RowVersion" "bigint" not null,
		"StatusCode" "int" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "Negotiation" with nocheck add 
		constraint "NegotiationKey" primary key clustered
		(
			"NegotiationId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "Negotiation" with nocheck add 
		constraint "DefaultNegotiationIsArchived" default (0) for "IsArchived",
		constraint "DefaultNegotiationIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'Negotiation')
		update "VersionControl" set "Revision" = 0 where "Name" = 'Negotiation'
	else
		insert "VersionControl" ("Name", "Revision") select 'Negotiation', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'Negotiation'
	print convert(varchar, getdate(), 120) + 'Z Table: "Negotiation", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'Negotiation'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "Negotiation", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The SourceOrder Table */
if not exists (select * from "VersionControl" where "Name" = 'SourceOrder')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "SourceOrder" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'SourceOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "SourceOrder", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'SourceOrder'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'SourceOrder'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Destination_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_Destination_SourceOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_OrderType_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_OrderType_SourceOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_SourceOrder_SecurityId')
		alter table "SourceOrder" drop constraint "FK_Security_SourceOrder_SecurityId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Security_SourceOrder_SettlementId')
		alter table "SourceOrder" drop constraint "FK_Security_SourceOrder_SettlementId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Side_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_Side_SourceOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_Status_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_Status_SourceOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_TimeInForce_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_TimeInForce_SourceOrder"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_SourceOrder_CreatedUserId')
		alter table "SourceOrder" drop constraint "FK_User_SourceOrder_CreatedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_User_SourceOrder_ModifiedUserId')
		alter table "SourceOrder" drop constraint "FK_User_SourceOrder_ModifiedUserId"
	if exists (select * from sysobjects where type = 'F' and name = 'FK_WorkingOrder_SourceOrder')
		alter table "SourceOrder" drop constraint "FK_WorkingOrder_SourceOrder"
	if exists (select * from sysobjects where type = 'U' and name = 'SourceOrder')
		drop table "SourceOrder"

	/* Create the table. */
	create table "SourceOrder" (
		"CreatedTime" "datetime" not null,
		"CreatedUserId" "uniqueIdentifier" not null,
		"DestinationId" "uniqueIdentifier" null,
		"ExternalId0" "nvarchar"(128) null,
		"IsAdvertised" "bit" not null,
		"IsAutoExecute" "bit" not null,
		"IsCanceled" "bit" not null,
		"IsHeld" "bit" not null,
		"IsSteppedIn" "bit" not null,
		"IsSubmitted" "bit" not null,
		"LimitPrice" "decimal"(19,7) null,
		"MaximumVolatility" "decimal"(19,7) null,
		"ModifiedTime" "datetime" not null,
		"ModifiedUserId" "uniqueIdentifier" not null,
		"NewsFreeTime" "int" null,
		"OrderedQuantity" "decimal"(19,7) not null,
		"OrderTypeCode" "int" not null,
		"ReceivedTime" "nvarchar"(max) null,
		"RowVersion" "bigint" not null,
		"SecurityId" "uniqueIdentifier" not null,
		"SettlementDate" "datetime" null,
		"SettlementId" "uniqueIdentifier" null,
		"SideCode" "int" not null,
		"SourceOrderId" "uniqueIdentifier" not null,
		"StartTime" "datetime" null,
		"StatusCode" "int" not null,
		"StopPrice" "decimal"(19,7) null,
		"StopTime" "datetime" null,
		"SubmittedQuantity" "decimal"(19,7) not null,
		"SubmittedTime" "nvarchar"(max) null,
		"TargetPrice" "decimal"(19,7) null,
		"TimeInForceCode" "int" not null,
		"TradeDate" "datetime" null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "SourceOrder" with nocheck add 
		constraint "SourceOrderKey" primary key clustered
		(
			"SourceOrderId"
		)  on "PRIMARY" 


	/* Non-Unique Indices */
	create index "SourceOrderKeyExternalId0"
		on "SourceOrder"
		(
			"ExternalId0"
		)  on "PRIMARY" 

	/* Defaults */
	alter table "SourceOrder" with nocheck add 
		constraint "DefaultSourceOrderIsArchived" default (0) for "IsArchived",
		constraint "DefaultSourceOrderIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'SourceOrder')
		update "VersionControl" set "Revision" = 0 where "Name" = 'SourceOrder'
	else
		insert "VersionControl" ("Name", "Revision") select 'SourceOrder', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'SourceOrder'
	print convert(varchar, getdate(), 120) + 'Z Table: "SourceOrder", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'SourceOrder'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "SourceOrder", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

/* The WorkingOrderTimer Table */
if not exists (select * from "VersionControl" where "Name" = 'WorkingOrderTimer')
	print convert(varchar, getdate(), 120) + 'Z <Undefined>: "WorkingOrderTimer" doesn''t exist in the catalogs.'
else
begin
	declare @revision "decimal"
	select @revision = "Revision" from "VersionControl" where "Name" = 'WorkingOrderTimer'
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrderTimer", Initial revision: ' + convert(varchar, @revision)
end

/* This checks the version control table to determine if an update is needed. */
declare @currentRevision "decimal"
declare @requiredRevision "decimal"
select @currentRevision = isnull((select "Revision" from "VersionControl" where "VersionControl"."Name" = 'WorkingOrderTimer'), -1.0)
select @requiredRevision = isnull((select "Revision" from "VersionHistory", "VersionTag"
	where "VersionHistory"."Active" = 1 and "VersionHistory"."Label" = "VersionTag"."Label" and	"VersionTag"."Name" = 'WorkingOrderTimer'), 0)
if @currentRevision < 0 and 0 <= @requiredRevision
begin

	/* The revision must be completed as a unit. */
	begin transaction

	/* Remove the object and any dependancies. */
	if exists (select * from sysobjects where type = 'U' and name = 'WorkingOrderTimer')
		drop table "WorkingOrderTimer"

	/* Create the table. */
	create table "WorkingOrderTimer" (
		"CurrentTime" "datetime" not null,
		"RowVersion" "bigint" not null,
		"StopTime" "datetime" not null,
		"WorkingOrderId" "uniqueIdentifier" not null,
		"WorkingOrderTimerId" "uniqueIdentifier" not null,
		"IsArchived" "bit" not null,
		"IsDeleted" "bit" not null,
	) on "PRIMARY"

	/* Unique Constraints */
	alter table "WorkingOrderTimer" with nocheck add 
		constraint "WorkingOrderTimerKey" primary key clustered
		(
			"WorkingOrderTimerId"
		)  on "PRIMARY" 


	/* Defaults */
	alter table "WorkingOrderTimer" with nocheck add 
		constraint "DefaultWorkingOrderTimerIsArchived" default (0) for "IsArchived",
		constraint "DefaultWorkingOrderTimerIsDeleted" default (0) for "IsDeleted"

	/* Update the versionControl table to reflect the change. */
	if exists (select * from "VersionControl" where "Name" = 'WorkingOrderTimer')
		update "VersionControl" set "Revision" = 0 where "Name" = 'WorkingOrderTimer'
	else
		insert "VersionControl" ("Name", "Revision") select 'WorkingOrderTimer', 0

	/* Commit the changes to the table. */
	commit transaction

end
go

if @@error = 0
begin
	declare @newRevision "decimal"
	select @newRevision = "Revision" from "VersionControl" where "Name" = 'WorkingOrderTimer'
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrderTimer", Final revision: ' + convert(varchar, @newRevision)
end
else
begin
	declare @oldRevision "decimal"
	select @oldRevision = isnull((select "Revision" from "VersionControl" where "Name" = 'WorkingOrderTimer'), 0.0)
	print convert(varchar, getdate(), 120) + 'Z Table: "WorkingOrderTimer", Error upgrading from revision: ' + convert(varchar, @oldRevision)
end
go

